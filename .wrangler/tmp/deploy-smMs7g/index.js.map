{
  "version": 3,
  "sources": ["../../../node_modules/hono/dist/compose.js", "../../../node_modules/hono/dist/request/constants.js", "../../../node_modules/hono/dist/utils/body.js", "../../../node_modules/hono/dist/utils/url.js", "../../../node_modules/hono/dist/request.js", "../../../node_modules/hono/dist/utils/html.js", "../../../node_modules/hono/dist/context.js", "../../../node_modules/hono/dist/router.js", "../../../node_modules/hono/dist/utils/constants.js", "../../../node_modules/hono/dist/hono-base.js", "../../../node_modules/hono/dist/router/reg-exp-router/matcher.js", "../../../node_modules/hono/dist/router/reg-exp-router/node.js", "../../../node_modules/hono/dist/router/reg-exp-router/trie.js", "../../../node_modules/hono/dist/router/reg-exp-router/router.js", "../../../node_modules/hono/dist/router/smart-router/router.js", "../../../node_modules/hono/dist/router/trie-router/node.js", "../../../node_modules/hono/dist/router/trie-router/router.js", "../../../node_modules/hono/dist/hono.js", "../../../node_modules/hono/dist/middleware/cors/index.js", "../../../src/routes/registry.ts", "../../../src/routes/agents.ts", "../../../src/routes/payments.ts", "../../../src/routes/analytics.ts", "../../../src/routes/dev.ts", "../../../src/index.ts"],
  "sourceRoot": "/home/publius/dev/personal/x402-registry/.wrangler/tmp/deploy-smMs7g",
  "sourcesContent": ["// src/compose.ts\nvar compose = (middleware, onError, onNotFound) => {\n  return (context, next) => {\n    let index = -1;\n    return dispatch(0);\n    async function dispatch(i) {\n      if (i <= index) {\n        throw new Error(\"next() called multiple times\");\n      }\n      index = i;\n      let res;\n      let isError = false;\n      let handler;\n      if (middleware[i]) {\n        handler = middleware[i][0][0];\n        context.req.routeIndex = i;\n      } else {\n        handler = i === middleware.length && next || void 0;\n      }\n      if (handler) {\n        try {\n          res = await handler(context, () => dispatch(i + 1));\n        } catch (err) {\n          if (err instanceof Error && onError) {\n            context.error = err;\n            res = await onError(err, context);\n            isError = true;\n          } else {\n            throw err;\n          }\n        }\n      } else {\n        if (context.finalized === false && onNotFound) {\n          res = await onNotFound(context);\n        }\n      }\n      if (res && (context.finalized === false || isError)) {\n        context.res = res;\n      }\n      return context;\n    }\n  };\n};\nexport {\n  compose\n};\n", "// src/request/constants.ts\nvar GET_MATCH_RESULT = /* @__PURE__ */ Symbol();\nexport {\n  GET_MATCH_RESULT\n};\n", "// src/utils/body.ts\nimport { HonoRequest } from \"../request.js\";\nvar parseBody = async (request, options = /* @__PURE__ */ Object.create(null)) => {\n  const { all = false, dot = false } = options;\n  const headers = request instanceof HonoRequest ? request.raw.headers : request.headers;\n  const contentType = headers.get(\"Content-Type\");\n  if (contentType?.startsWith(\"multipart/form-data\") || contentType?.startsWith(\"application/x-www-form-urlencoded\")) {\n    return parseFormData(request, { all, dot });\n  }\n  return {};\n};\nasync function parseFormData(request, options) {\n  const formData = await request.formData();\n  if (formData) {\n    return convertFormDataToBodyData(formData, options);\n  }\n  return {};\n}\nfunction convertFormDataToBodyData(formData, options) {\n  const form = /* @__PURE__ */ Object.create(null);\n  formData.forEach((value, key) => {\n    const shouldParseAllValues = options.all || key.endsWith(\"[]\");\n    if (!shouldParseAllValues) {\n      form[key] = value;\n    } else {\n      handleParsingAllValues(form, key, value);\n    }\n  });\n  if (options.dot) {\n    Object.entries(form).forEach(([key, value]) => {\n      const shouldParseDotValues = key.includes(\".\");\n      if (shouldParseDotValues) {\n        handleParsingNestedValues(form, key, value);\n        delete form[key];\n      }\n    });\n  }\n  return form;\n}\nvar handleParsingAllValues = (form, key, value) => {\n  if (form[key] !== void 0) {\n    if (Array.isArray(form[key])) {\n      ;\n      form[key].push(value);\n    } else {\n      form[key] = [form[key], value];\n    }\n  } else {\n    if (!key.endsWith(\"[]\")) {\n      form[key] = value;\n    } else {\n      form[key] = [value];\n    }\n  }\n};\nvar handleParsingNestedValues = (form, key, value) => {\n  let nestedForm = form;\n  const keys = key.split(\".\");\n  keys.forEach((key2, index) => {\n    if (index === keys.length - 1) {\n      nestedForm[key2] = value;\n    } else {\n      if (!nestedForm[key2] || typeof nestedForm[key2] !== \"object\" || Array.isArray(nestedForm[key2]) || nestedForm[key2] instanceof File) {\n        nestedForm[key2] = /* @__PURE__ */ Object.create(null);\n      }\n      nestedForm = nestedForm[key2];\n    }\n  });\n};\nexport {\n  parseBody\n};\n", "// src/utils/url.ts\nvar splitPath = (path) => {\n  const paths = path.split(\"/\");\n  if (paths[0] === \"\") {\n    paths.shift();\n  }\n  return paths;\n};\nvar splitRoutingPath = (routePath) => {\n  const { groups, path } = extractGroupsFromPath(routePath);\n  const paths = splitPath(path);\n  return replaceGroupMarks(paths, groups);\n};\nvar extractGroupsFromPath = (path) => {\n  const groups = [];\n  path = path.replace(/\\{[^}]+\\}/g, (match, index) => {\n    const mark = `@${index}`;\n    groups.push([mark, match]);\n    return mark;\n  });\n  return { groups, path };\n};\nvar replaceGroupMarks = (paths, groups) => {\n  for (let i = groups.length - 1; i >= 0; i--) {\n    const [mark] = groups[i];\n    for (let j = paths.length - 1; j >= 0; j--) {\n      if (paths[j].includes(mark)) {\n        paths[j] = paths[j].replace(mark, groups[i][1]);\n        break;\n      }\n    }\n  }\n  return paths;\n};\nvar patternCache = {};\nvar getPattern = (label, next) => {\n  if (label === \"*\") {\n    return \"*\";\n  }\n  const match = label.match(/^\\:([^\\{\\}]+)(?:\\{(.+)\\})?$/);\n  if (match) {\n    const cacheKey = `${label}#${next}`;\n    if (!patternCache[cacheKey]) {\n      if (match[2]) {\n        patternCache[cacheKey] = next && next[0] !== \":\" && next[0] !== \"*\" ? [cacheKey, match[1], new RegExp(`^${match[2]}(?=/${next})`)] : [label, match[1], new RegExp(`^${match[2]}$`)];\n      } else {\n        patternCache[cacheKey] = [label, match[1], true];\n      }\n    }\n    return patternCache[cacheKey];\n  }\n  return null;\n};\nvar tryDecode = (str, decoder) => {\n  try {\n    return decoder(str);\n  } catch {\n    return str.replace(/(?:%[0-9A-Fa-f]{2})+/g, (match) => {\n      try {\n        return decoder(match);\n      } catch {\n        return match;\n      }\n    });\n  }\n};\nvar tryDecodeURI = (str) => tryDecode(str, decodeURI);\nvar getPath = (request) => {\n  const url = request.url;\n  const start = url.indexOf(\"/\", url.indexOf(\":\") + 4);\n  let i = start;\n  for (; i < url.length; i++) {\n    const charCode = url.charCodeAt(i);\n    if (charCode === 37) {\n      const queryIndex = url.indexOf(\"?\", i);\n      const path = url.slice(start, queryIndex === -1 ? void 0 : queryIndex);\n      return tryDecodeURI(path.includes(\"%25\") ? path.replace(/%25/g, \"%2525\") : path);\n    } else if (charCode === 63) {\n      break;\n    }\n  }\n  return url.slice(start, i);\n};\nvar getQueryStrings = (url) => {\n  const queryIndex = url.indexOf(\"?\", 8);\n  return queryIndex === -1 ? \"\" : \"?\" + url.slice(queryIndex + 1);\n};\nvar getPathNoStrict = (request) => {\n  const result = getPath(request);\n  return result.length > 1 && result.at(-1) === \"/\" ? result.slice(0, -1) : result;\n};\nvar mergePath = (base, sub, ...rest) => {\n  if (rest.length) {\n    sub = mergePath(sub, ...rest);\n  }\n  return `${base?.[0] === \"/\" ? \"\" : \"/\"}${base}${sub === \"/\" ? \"\" : `${base?.at(-1) === \"/\" ? \"\" : \"/\"}${sub?.[0] === \"/\" ? sub.slice(1) : sub}`}`;\n};\nvar checkOptionalParameter = (path) => {\n  if (path.charCodeAt(path.length - 1) !== 63 || !path.includes(\":\")) {\n    return null;\n  }\n  const segments = path.split(\"/\");\n  const results = [];\n  let basePath = \"\";\n  segments.forEach((segment) => {\n    if (segment !== \"\" && !/\\:/.test(segment)) {\n      basePath += \"/\" + segment;\n    } else if (/\\:/.test(segment)) {\n      if (/\\?/.test(segment)) {\n        if (results.length === 0 && basePath === \"\") {\n          results.push(\"/\");\n        } else {\n          results.push(basePath);\n        }\n        const optionalSegment = segment.replace(\"?\", \"\");\n        basePath += \"/\" + optionalSegment;\n        results.push(basePath);\n      } else {\n        basePath += \"/\" + segment;\n      }\n    }\n  });\n  return results.filter((v, i, a) => a.indexOf(v) === i);\n};\nvar _decodeURI = (value) => {\n  if (!/[%+]/.test(value)) {\n    return value;\n  }\n  if (value.indexOf(\"+\") !== -1) {\n    value = value.replace(/\\+/g, \" \");\n  }\n  return value.indexOf(\"%\") !== -1 ? tryDecode(value, decodeURIComponent_) : value;\n};\nvar _getQueryParam = (url, key, multiple) => {\n  let encoded;\n  if (!multiple && key && !/[%+]/.test(key)) {\n    let keyIndex2 = url.indexOf(\"?\", 8);\n    if (keyIndex2 === -1) {\n      return void 0;\n    }\n    if (!url.startsWith(key, keyIndex2 + 1)) {\n      keyIndex2 = url.indexOf(`&${key}`, keyIndex2 + 1);\n    }\n    while (keyIndex2 !== -1) {\n      const trailingKeyCode = url.charCodeAt(keyIndex2 + key.length + 1);\n      if (trailingKeyCode === 61) {\n        const valueIndex = keyIndex2 + key.length + 2;\n        const endIndex = url.indexOf(\"&\", valueIndex);\n        return _decodeURI(url.slice(valueIndex, endIndex === -1 ? void 0 : endIndex));\n      } else if (trailingKeyCode == 38 || isNaN(trailingKeyCode)) {\n        return \"\";\n      }\n      keyIndex2 = url.indexOf(`&${key}`, keyIndex2 + 1);\n    }\n    encoded = /[%+]/.test(url);\n    if (!encoded) {\n      return void 0;\n    }\n  }\n  const results = {};\n  encoded ??= /[%+]/.test(url);\n  let keyIndex = url.indexOf(\"?\", 8);\n  while (keyIndex !== -1) {\n    const nextKeyIndex = url.indexOf(\"&\", keyIndex + 1);\n    let valueIndex = url.indexOf(\"=\", keyIndex);\n    if (valueIndex > nextKeyIndex && nextKeyIndex !== -1) {\n      valueIndex = -1;\n    }\n    let name = url.slice(\n      keyIndex + 1,\n      valueIndex === -1 ? nextKeyIndex === -1 ? void 0 : nextKeyIndex : valueIndex\n    );\n    if (encoded) {\n      name = _decodeURI(name);\n    }\n    keyIndex = nextKeyIndex;\n    if (name === \"\") {\n      continue;\n    }\n    let value;\n    if (valueIndex === -1) {\n      value = \"\";\n    } else {\n      value = url.slice(valueIndex + 1, nextKeyIndex === -1 ? void 0 : nextKeyIndex);\n      if (encoded) {\n        value = _decodeURI(value);\n      }\n    }\n    if (multiple) {\n      if (!(results[name] && Array.isArray(results[name]))) {\n        results[name] = [];\n      }\n      ;\n      results[name].push(value);\n    } else {\n      results[name] ??= value;\n    }\n  }\n  return key ? results[key] : results;\n};\nvar getQueryParam = _getQueryParam;\nvar getQueryParams = (url, key) => {\n  return _getQueryParam(url, key, true);\n};\nvar decodeURIComponent_ = decodeURIComponent;\nexport {\n  checkOptionalParameter,\n  decodeURIComponent_,\n  getPath,\n  getPathNoStrict,\n  getPattern,\n  getQueryParam,\n  getQueryParams,\n  getQueryStrings,\n  mergePath,\n  splitPath,\n  splitRoutingPath,\n  tryDecode\n};\n", "// src/request.ts\nimport { HTTPException } from \"./http-exception.js\";\nimport { GET_MATCH_RESULT } from \"./request/constants.js\";\nimport { parseBody } from \"./utils/body.js\";\nimport { decodeURIComponent_, getQueryParam, getQueryParams, tryDecode } from \"./utils/url.js\";\nvar tryDecodeURIComponent = (str) => tryDecode(str, decodeURIComponent_);\nvar HonoRequest = class {\n  /**\n   * `.raw` can get the raw Request object.\n   *\n   * @see {@link https://hono.dev/docs/api/request#raw}\n   *\n   * @example\n   * ```ts\n   * // For Cloudflare Workers\n   * app.post('/', async (c) => {\n   *   const metadata = c.req.raw.cf?.hostMetadata?\n   *   ...\n   * })\n   * ```\n   */\n  raw;\n  #validatedData;\n  // Short name of validatedData\n  #matchResult;\n  routeIndex = 0;\n  /**\n   * `.path` can get the pathname of the request.\n   *\n   * @see {@link https://hono.dev/docs/api/request#path}\n   *\n   * @example\n   * ```ts\n   * app.get('/about/me', (c) => {\n   *   const pathname = c.req.path // `/about/me`\n   * })\n   * ```\n   */\n  path;\n  bodyCache = {};\n  constructor(request, path = \"/\", matchResult = [[]]) {\n    this.raw = request;\n    this.path = path;\n    this.#matchResult = matchResult;\n    this.#validatedData = {};\n  }\n  param(key) {\n    return key ? this.#getDecodedParam(key) : this.#getAllDecodedParams();\n  }\n  #getDecodedParam(key) {\n    const paramKey = this.#matchResult[0][this.routeIndex][1][key];\n    const param = this.#getParamValue(paramKey);\n    return param && /\\%/.test(param) ? tryDecodeURIComponent(param) : param;\n  }\n  #getAllDecodedParams() {\n    const decoded = {};\n    const keys = Object.keys(this.#matchResult[0][this.routeIndex][1]);\n    for (const key of keys) {\n      const value = this.#getParamValue(this.#matchResult[0][this.routeIndex][1][key]);\n      if (value !== void 0) {\n        decoded[key] = /\\%/.test(value) ? tryDecodeURIComponent(value) : value;\n      }\n    }\n    return decoded;\n  }\n  #getParamValue(paramKey) {\n    return this.#matchResult[1] ? this.#matchResult[1][paramKey] : paramKey;\n  }\n  query(key) {\n    return getQueryParam(this.url, key);\n  }\n  queries(key) {\n    return getQueryParams(this.url, key);\n  }\n  header(name) {\n    if (name) {\n      return this.raw.headers.get(name) ?? void 0;\n    }\n    const headerData = {};\n    this.raw.headers.forEach((value, key) => {\n      headerData[key] = value;\n    });\n    return headerData;\n  }\n  async parseBody(options) {\n    return this.bodyCache.parsedBody ??= await parseBody(this, options);\n  }\n  #cachedBody = (key) => {\n    const { bodyCache, raw } = this;\n    const cachedBody = bodyCache[key];\n    if (cachedBody) {\n      return cachedBody;\n    }\n    const anyCachedKey = Object.keys(bodyCache)[0];\n    if (anyCachedKey) {\n      return bodyCache[anyCachedKey].then((body) => {\n        if (anyCachedKey === \"json\") {\n          body = JSON.stringify(body);\n        }\n        return new Response(body)[key]();\n      });\n    }\n    return bodyCache[key] = raw[key]();\n  };\n  /**\n   * `.json()` can parse Request body of type `application/json`\n   *\n   * @see {@link https://hono.dev/docs/api/request#json}\n   *\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.json()\n   * })\n   * ```\n   */\n  json() {\n    return this.#cachedBody(\"text\").then((text) => JSON.parse(text));\n  }\n  /**\n   * `.text()` can parse Request body of type `text/plain`\n   *\n   * @see {@link https://hono.dev/docs/api/request#text}\n   *\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.text()\n   * })\n   * ```\n   */\n  text() {\n    return this.#cachedBody(\"text\");\n  }\n  /**\n   * `.arrayBuffer()` parse Request body as an `ArrayBuffer`\n   *\n   * @see {@link https://hono.dev/docs/api/request#arraybuffer}\n   *\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.arrayBuffer()\n   * })\n   * ```\n   */\n  arrayBuffer() {\n    return this.#cachedBody(\"arrayBuffer\");\n  }\n  /**\n   * Parses the request body as a `Blob`.\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.blob();\n   * });\n   * ```\n   * @see https://hono.dev/docs/api/request#blob\n   */\n  blob() {\n    return this.#cachedBody(\"blob\");\n  }\n  /**\n   * Parses the request body as `FormData`.\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.formData();\n   * });\n   * ```\n   * @see https://hono.dev/docs/api/request#formdata\n   */\n  formData() {\n    return this.#cachedBody(\"formData\");\n  }\n  /**\n   * Adds validated data to the request.\n   *\n   * @param target - The target of the validation.\n   * @param data - The validated data to add.\n   */\n  addValidatedData(target, data) {\n    this.#validatedData[target] = data;\n  }\n  valid(target) {\n    return this.#validatedData[target];\n  }\n  /**\n   * `.url()` can get the request url strings.\n   *\n   * @see {@link https://hono.dev/docs/api/request#url}\n   *\n   * @example\n   * ```ts\n   * app.get('/about/me', (c) => {\n   *   const url = c.req.url // `http://localhost:8787/about/me`\n   *   ...\n   * })\n   * ```\n   */\n  get url() {\n    return this.raw.url;\n  }\n  /**\n   * `.method()` can get the method name of the request.\n   *\n   * @see {@link https://hono.dev/docs/api/request#method}\n   *\n   * @example\n   * ```ts\n   * app.get('/about/me', (c) => {\n   *   const method = c.req.method // `GET`\n   * })\n   * ```\n   */\n  get method() {\n    return this.raw.method;\n  }\n  get [GET_MATCH_RESULT]() {\n    return this.#matchResult;\n  }\n  /**\n   * `.matchedRoutes()` can return a matched route in the handler\n   *\n   * @deprecated\n   *\n   * Use matchedRoutes helper defined in \"hono/route\" instead.\n   *\n   * @see {@link https://hono.dev/docs/api/request#matchedroutes}\n   *\n   * @example\n   * ```ts\n   * app.use('*', async function logger(c, next) {\n   *   await next()\n   *   c.req.matchedRoutes.forEach(({ handler, method, path }, i) => {\n   *     const name = handler.name || (handler.length < 2 ? '[handler]' : '[middleware]')\n   *     console.log(\n   *       method,\n   *       ' ',\n   *       path,\n   *       ' '.repeat(Math.max(10 - path.length, 0)),\n   *       name,\n   *       i === c.req.routeIndex ? '<- respond from here' : ''\n   *     )\n   *   })\n   * })\n   * ```\n   */\n  get matchedRoutes() {\n    return this.#matchResult[0].map(([[, route]]) => route);\n  }\n  /**\n   * `routePath()` can retrieve the path registered within the handler\n   *\n   * @deprecated\n   *\n   * Use routePath helper defined in \"hono/route\" instead.\n   *\n   * @see {@link https://hono.dev/docs/api/request#routepath}\n   *\n   * @example\n   * ```ts\n   * app.get('/posts/:id', (c) => {\n   *   return c.json({ path: c.req.routePath })\n   * })\n   * ```\n   */\n  get routePath() {\n    return this.#matchResult[0].map(([[, route]]) => route)[this.routeIndex].path;\n  }\n};\nvar cloneRawRequest = async (req) => {\n  if (!req.raw.bodyUsed) {\n    return req.raw.clone();\n  }\n  const cacheKey = Object.keys(req.bodyCache)[0];\n  if (!cacheKey) {\n    throw new HTTPException(500, {\n      message: \"Cannot clone request: body was already consumed and not cached. Please use HonoRequest methods (e.g., req.json(), req.text()) instead of consuming req.raw directly.\"\n    });\n  }\n  const requestInit = {\n    body: await req[cacheKey](),\n    cache: req.raw.cache,\n    credentials: req.raw.credentials,\n    headers: req.header(),\n    integrity: req.raw.integrity,\n    keepalive: req.raw.keepalive,\n    method: req.method,\n    mode: req.raw.mode,\n    redirect: req.raw.redirect,\n    referrer: req.raw.referrer,\n    referrerPolicy: req.raw.referrerPolicy,\n    signal: req.raw.signal\n  };\n  return new Request(req.url, requestInit);\n};\nexport {\n  HonoRequest,\n  cloneRawRequest\n};\n", "// src/utils/html.ts\nvar HtmlEscapedCallbackPhase = {\n  Stringify: 1,\n  BeforeStream: 2,\n  Stream: 3\n};\nvar raw = (value, callbacks) => {\n  const escapedString = new String(value);\n  escapedString.isEscaped = true;\n  escapedString.callbacks = callbacks;\n  return escapedString;\n};\nvar escapeRe = /[&<>'\"]/;\nvar stringBufferToString = async (buffer, callbacks) => {\n  let str = \"\";\n  callbacks ||= [];\n  const resolvedBuffer = await Promise.all(buffer);\n  for (let i = resolvedBuffer.length - 1; ; i--) {\n    str += resolvedBuffer[i];\n    i--;\n    if (i < 0) {\n      break;\n    }\n    let r = resolvedBuffer[i];\n    if (typeof r === \"object\") {\n      callbacks.push(...r.callbacks || []);\n    }\n    const isEscaped = r.isEscaped;\n    r = await (typeof r === \"object\" ? r.toString() : r);\n    if (typeof r === \"object\") {\n      callbacks.push(...r.callbacks || []);\n    }\n    if (r.isEscaped ?? isEscaped) {\n      str += r;\n    } else {\n      const buf = [str];\n      escapeToBuffer(r, buf);\n      str = buf[0];\n    }\n  }\n  return raw(str, callbacks);\n};\nvar escapeToBuffer = (str, buffer) => {\n  const match = str.search(escapeRe);\n  if (match === -1) {\n    buffer[0] += str;\n    return;\n  }\n  let escape;\n  let index;\n  let lastIndex = 0;\n  for (index = match; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34:\n        escape = \"&quot;\";\n        break;\n      case 39:\n        escape = \"&#39;\";\n        break;\n      case 38:\n        escape = \"&amp;\";\n        break;\n      case 60:\n        escape = \"&lt;\";\n        break;\n      case 62:\n        escape = \"&gt;\";\n        break;\n      default:\n        continue;\n    }\n    buffer[0] += str.substring(lastIndex, index) + escape;\n    lastIndex = index + 1;\n  }\n  buffer[0] += str.substring(lastIndex, index);\n};\nvar resolveCallbackSync = (str) => {\n  const callbacks = str.callbacks;\n  if (!callbacks?.length) {\n    return str;\n  }\n  const buffer = [str];\n  const context = {};\n  callbacks.forEach((c) => c({ phase: HtmlEscapedCallbackPhase.Stringify, buffer, context }));\n  return buffer[0];\n};\nvar resolveCallback = async (str, phase, preserveCallbacks, context, buffer) => {\n  if (typeof str === \"object\" && !(str instanceof String)) {\n    if (!(str instanceof Promise)) {\n      str = str.toString();\n    }\n    if (str instanceof Promise) {\n      str = await str;\n    }\n  }\n  const callbacks = str.callbacks;\n  if (!callbacks?.length) {\n    return Promise.resolve(str);\n  }\n  if (buffer) {\n    buffer[0] += str;\n  } else {\n    buffer = [str];\n  }\n  const resStr = Promise.all(callbacks.map((c) => c({ phase, buffer, context }))).then(\n    (res) => Promise.all(\n      res.filter(Boolean).map((str2) => resolveCallback(str2, phase, false, context, buffer))\n    ).then(() => buffer[0])\n  );\n  if (preserveCallbacks) {\n    return raw(await resStr, callbacks);\n  } else {\n    return resStr;\n  }\n};\nexport {\n  HtmlEscapedCallbackPhase,\n  escapeToBuffer,\n  raw,\n  resolveCallback,\n  resolveCallbackSync,\n  stringBufferToString\n};\n", "// src/context.ts\nimport { HonoRequest } from \"./request.js\";\nimport { HtmlEscapedCallbackPhase, resolveCallback } from \"./utils/html.js\";\nvar TEXT_PLAIN = \"text/plain; charset=UTF-8\";\nvar setDefaultContentType = (contentType, headers) => {\n  return {\n    \"Content-Type\": contentType,\n    ...headers\n  };\n};\nvar Context = class {\n  #rawRequest;\n  #req;\n  /**\n   * `.env` can get bindings (environment variables, secrets, KV namespaces, D1 database, R2 bucket etc.) in Cloudflare Workers.\n   *\n   * @see {@link https://hono.dev/docs/api/context#env}\n   *\n   * @example\n   * ```ts\n   * // Environment object for Cloudflare Workers\n   * app.get('*', async c => {\n   *   const counter = c.env.COUNTER\n   * })\n   * ```\n   */\n  env = {};\n  #var;\n  finalized = false;\n  /**\n   * `.error` can get the error object from the middleware if the Handler throws an error.\n   *\n   * @see {@link https://hono.dev/docs/api/context#error}\n   *\n   * @example\n   * ```ts\n   * app.use('*', async (c, next) => {\n   *   await next()\n   *   if (c.error) {\n   *     // do something...\n   *   }\n   * })\n   * ```\n   */\n  error;\n  #status;\n  #executionCtx;\n  #res;\n  #layout;\n  #renderer;\n  #notFoundHandler;\n  #preparedHeaders;\n  #matchResult;\n  #path;\n  /**\n   * Creates an instance of the Context class.\n   *\n   * @param req - The Request object.\n   * @param options - Optional configuration options for the context.\n   */\n  constructor(req, options) {\n    this.#rawRequest = req;\n    if (options) {\n      this.#executionCtx = options.executionCtx;\n      this.env = options.env;\n      this.#notFoundHandler = options.notFoundHandler;\n      this.#path = options.path;\n      this.#matchResult = options.matchResult;\n    }\n  }\n  /**\n   * `.req` is the instance of {@link HonoRequest}.\n   */\n  get req() {\n    this.#req ??= new HonoRequest(this.#rawRequest, this.#path, this.#matchResult);\n    return this.#req;\n  }\n  /**\n   * @see {@link https://hono.dev/docs/api/context#event}\n   * The FetchEvent associated with the current request.\n   *\n   * @throws Will throw an error if the context does not have a FetchEvent.\n   */\n  get event() {\n    if (this.#executionCtx && \"respondWith\" in this.#executionCtx) {\n      return this.#executionCtx;\n    } else {\n      throw Error(\"This context has no FetchEvent\");\n    }\n  }\n  /**\n   * @see {@link https://hono.dev/docs/api/context#executionctx}\n   * The ExecutionContext associated with the current request.\n   *\n   * @throws Will throw an error if the context does not have an ExecutionContext.\n   */\n  get executionCtx() {\n    if (this.#executionCtx) {\n      return this.#executionCtx;\n    } else {\n      throw Error(\"This context has no ExecutionContext\");\n    }\n  }\n  /**\n   * @see {@link https://hono.dev/docs/api/context#res}\n   * The Response object for the current request.\n   */\n  get res() {\n    return this.#res ||= new Response(null, {\n      headers: this.#preparedHeaders ??= new Headers()\n    });\n  }\n  /**\n   * Sets the Response object for the current request.\n   *\n   * @param _res - The Response object to set.\n   */\n  set res(_res) {\n    if (this.#res && _res) {\n      _res = new Response(_res.body, _res);\n      for (const [k, v] of this.#res.headers.entries()) {\n        if (k === \"content-type\") {\n          continue;\n        }\n        if (k === \"set-cookie\") {\n          const cookies = this.#res.headers.getSetCookie();\n          _res.headers.delete(\"set-cookie\");\n          for (const cookie of cookies) {\n            _res.headers.append(\"set-cookie\", cookie);\n          }\n        } else {\n          _res.headers.set(k, v);\n        }\n      }\n    }\n    this.#res = _res;\n    this.finalized = true;\n  }\n  /**\n   * `.render()` can create a response within a layout.\n   *\n   * @see {@link https://hono.dev/docs/api/context#render-setrenderer}\n   *\n   * @example\n   * ```ts\n   * app.get('/', (c) => {\n   *   return c.render('Hello!')\n   * })\n   * ```\n   */\n  render = (...args) => {\n    this.#renderer ??= (content) => this.html(content);\n    return this.#renderer(...args);\n  };\n  /**\n   * Sets the layout for the response.\n   *\n   * @param layout - The layout to set.\n   * @returns The layout function.\n   */\n  setLayout = (layout) => this.#layout = layout;\n  /**\n   * Gets the current layout for the response.\n   *\n   * @returns The current layout function.\n   */\n  getLayout = () => this.#layout;\n  /**\n   * `.setRenderer()` can set the layout in the custom middleware.\n   *\n   * @see {@link https://hono.dev/docs/api/context#render-setrenderer}\n   *\n   * @example\n   * ```tsx\n   * app.use('*', async (c, next) => {\n   *   c.setRenderer((content) => {\n   *     return c.html(\n   *       <html>\n   *         <body>\n   *           <p>{content}</p>\n   *         </body>\n   *       </html>\n   *     )\n   *   })\n   *   await next()\n   * })\n   * ```\n   */\n  setRenderer = (renderer) => {\n    this.#renderer = renderer;\n  };\n  /**\n   * `.header()` can set headers.\n   *\n   * @see {@link https://hono.dev/docs/api/context#header}\n   *\n   * @example\n   * ```ts\n   * app.get('/welcome', (c) => {\n   *   // Set headers\n   *   c.header('X-Message', 'Hello!')\n   *   c.header('Content-Type', 'text/plain')\n   *\n   *   return c.body('Thank you for coming')\n   * })\n   * ```\n   */\n  header = (name, value, options) => {\n    if (this.finalized) {\n      this.#res = new Response(this.#res.body, this.#res);\n    }\n    const headers = this.#res ? this.#res.headers : this.#preparedHeaders ??= new Headers();\n    if (value === void 0) {\n      headers.delete(name);\n    } else if (options?.append) {\n      headers.append(name, value);\n    } else {\n      headers.set(name, value);\n    }\n  };\n  status = (status) => {\n    this.#status = status;\n  };\n  /**\n   * `.set()` can set the value specified by the key.\n   *\n   * @see {@link https://hono.dev/docs/api/context#set-get}\n   *\n   * @example\n   * ```ts\n   * app.use('*', async (c, next) => {\n   *   c.set('message', 'Hono is hot!!')\n   *   await next()\n   * })\n   * ```\n   */\n  set = (key, value) => {\n    this.#var ??= /* @__PURE__ */ new Map();\n    this.#var.set(key, value);\n  };\n  /**\n   * `.get()` can use the value specified by the key.\n   *\n   * @see {@link https://hono.dev/docs/api/context#set-get}\n   *\n   * @example\n   * ```ts\n   * app.get('/', (c) => {\n   *   const message = c.get('message')\n   *   return c.text(`The message is \"${message}\"`)\n   * })\n   * ```\n   */\n  get = (key) => {\n    return this.#var ? this.#var.get(key) : void 0;\n  };\n  /**\n   * `.var` can access the value of a variable.\n   *\n   * @see {@link https://hono.dev/docs/api/context#var}\n   *\n   * @example\n   * ```ts\n   * const result = c.var.client.oneMethod()\n   * ```\n   */\n  // c.var.propName is a read-only\n  get var() {\n    if (!this.#var) {\n      return {};\n    }\n    return Object.fromEntries(this.#var);\n  }\n  #newResponse(data, arg, headers) {\n    const responseHeaders = this.#res ? new Headers(this.#res.headers) : this.#preparedHeaders ?? new Headers();\n    if (typeof arg === \"object\" && \"headers\" in arg) {\n      const argHeaders = arg.headers instanceof Headers ? arg.headers : new Headers(arg.headers);\n      for (const [key, value] of argHeaders) {\n        if (key.toLowerCase() === \"set-cookie\") {\n          responseHeaders.append(key, value);\n        } else {\n          responseHeaders.set(key, value);\n        }\n      }\n    }\n    if (headers) {\n      for (const [k, v] of Object.entries(headers)) {\n        if (typeof v === \"string\") {\n          responseHeaders.set(k, v);\n        } else {\n          responseHeaders.delete(k);\n          for (const v2 of v) {\n            responseHeaders.append(k, v2);\n          }\n        }\n      }\n    }\n    const status = typeof arg === \"number\" ? arg : arg?.status ?? this.#status;\n    return new Response(data, { status, headers: responseHeaders });\n  }\n  newResponse = (...args) => this.#newResponse(...args);\n  /**\n   * `.body()` can return the HTTP response.\n   * You can set headers with `.header()` and set HTTP status code with `.status`.\n   * This can also be set in `.text()`, `.json()` and so on.\n   *\n   * @see {@link https://hono.dev/docs/api/context#body}\n   *\n   * @example\n   * ```ts\n   * app.get('/welcome', (c) => {\n   *   // Set headers\n   *   c.header('X-Message', 'Hello!')\n   *   c.header('Content-Type', 'text/plain')\n   *   // Set HTTP status code\n   *   c.status(201)\n   *\n   *   // Return the response body\n   *   return c.body('Thank you for coming')\n   * })\n   * ```\n   */\n  body = (data, arg, headers) => this.#newResponse(data, arg, headers);\n  /**\n   * `.text()` can render text as `Content-Type:text/plain`.\n   *\n   * @see {@link https://hono.dev/docs/api/context#text}\n   *\n   * @example\n   * ```ts\n   * app.get('/say', (c) => {\n   *   return c.text('Hello!')\n   * })\n   * ```\n   */\n  text = (text, arg, headers) => {\n    return !this.#preparedHeaders && !this.#status && !arg && !headers && !this.finalized ? new Response(text) : this.#newResponse(\n      text,\n      arg,\n      setDefaultContentType(TEXT_PLAIN, headers)\n    );\n  };\n  /**\n   * `.json()` can render JSON as `Content-Type:application/json`.\n   *\n   * @see {@link https://hono.dev/docs/api/context#json}\n   *\n   * @example\n   * ```ts\n   * app.get('/api', (c) => {\n   *   return c.json({ message: 'Hello!' })\n   * })\n   * ```\n   */\n  json = (object, arg, headers) => {\n    return this.#newResponse(\n      JSON.stringify(object),\n      arg,\n      setDefaultContentType(\"application/json\", headers)\n    );\n  };\n  html = (html, arg, headers) => {\n    const res = (html2) => this.#newResponse(html2, arg, setDefaultContentType(\"text/html; charset=UTF-8\", headers));\n    return typeof html === \"object\" ? resolveCallback(html, HtmlEscapedCallbackPhase.Stringify, false, {}).then(res) : res(html);\n  };\n  /**\n   * `.redirect()` can Redirect, default status code is 302.\n   *\n   * @see {@link https://hono.dev/docs/api/context#redirect}\n   *\n   * @example\n   * ```ts\n   * app.get('/redirect', (c) => {\n   *   return c.redirect('/')\n   * })\n   * app.get('/redirect-permanently', (c) => {\n   *   return c.redirect('/', 301)\n   * })\n   * ```\n   */\n  redirect = (location, status) => {\n    const locationString = String(location);\n    this.header(\n      \"Location\",\n      // Multibyes should be encoded\n      // eslint-disable-next-line no-control-regex\n      !/[^\\x00-\\xFF]/.test(locationString) ? locationString : encodeURI(locationString)\n    );\n    return this.newResponse(null, status ?? 302);\n  };\n  /**\n   * `.notFound()` can return the Not Found Response.\n   *\n   * @see {@link https://hono.dev/docs/api/context#notfound}\n   *\n   * @example\n   * ```ts\n   * app.get('/notfound', (c) => {\n   *   return c.notFound()\n   * })\n   * ```\n   */\n  notFound = () => {\n    this.#notFoundHandler ??= () => new Response();\n    return this.#notFoundHandler(this);\n  };\n};\nexport {\n  Context,\n  TEXT_PLAIN\n};\n", "// src/router.ts\nvar METHOD_NAME_ALL = \"ALL\";\nvar METHOD_NAME_ALL_LOWERCASE = \"all\";\nvar METHODS = [\"get\", \"post\", \"put\", \"delete\", \"options\", \"patch\"];\nvar MESSAGE_MATCHER_IS_ALREADY_BUILT = \"Can not add a route since the matcher is already built.\";\nvar UnsupportedPathError = class extends Error {\n};\nexport {\n  MESSAGE_MATCHER_IS_ALREADY_BUILT,\n  METHODS,\n  METHOD_NAME_ALL,\n  METHOD_NAME_ALL_LOWERCASE,\n  UnsupportedPathError\n};\n", "// src/utils/constants.ts\nvar COMPOSED_HANDLER = \"__COMPOSED_HANDLER\";\nexport {\n  COMPOSED_HANDLER\n};\n", "// src/hono-base.ts\nimport { compose } from \"./compose.js\";\nimport { Context } from \"./context.js\";\nimport { METHODS, METHOD_NAME_ALL, METHOD_NAME_ALL_LOWERCASE } from \"./router.js\";\nimport { COMPOSED_HANDLER } from \"./utils/constants.js\";\nimport { getPath, getPathNoStrict, mergePath } from \"./utils/url.js\";\nvar notFoundHandler = (c) => {\n  return c.text(\"404 Not Found\", 404);\n};\nvar errorHandler = (err, c) => {\n  if (\"getResponse\" in err) {\n    const res = err.getResponse();\n    return c.newResponse(res.body, res);\n  }\n  console.error(err);\n  return c.text(\"Internal Server Error\", 500);\n};\nvar Hono = class _Hono {\n  get;\n  post;\n  put;\n  delete;\n  options;\n  patch;\n  all;\n  on;\n  use;\n  /*\n    This class is like an abstract class and does not have a router.\n    To use it, inherit the class and implement router in the constructor.\n  */\n  router;\n  getPath;\n  // Cannot use `#` because it requires visibility at JavaScript runtime.\n  _basePath = \"/\";\n  #path = \"/\";\n  routes = [];\n  constructor(options = {}) {\n    const allMethods = [...METHODS, METHOD_NAME_ALL_LOWERCASE];\n    allMethods.forEach((method) => {\n      this[method] = (args1, ...args) => {\n        if (typeof args1 === \"string\") {\n          this.#path = args1;\n        } else {\n          this.#addRoute(method, this.#path, args1);\n        }\n        args.forEach((handler) => {\n          this.#addRoute(method, this.#path, handler);\n        });\n        return this;\n      };\n    });\n    this.on = (method, path, ...handlers) => {\n      for (const p of [path].flat()) {\n        this.#path = p;\n        for (const m of [method].flat()) {\n          handlers.map((handler) => {\n            this.#addRoute(m.toUpperCase(), this.#path, handler);\n          });\n        }\n      }\n      return this;\n    };\n    this.use = (arg1, ...handlers) => {\n      if (typeof arg1 === \"string\") {\n        this.#path = arg1;\n      } else {\n        this.#path = \"*\";\n        handlers.unshift(arg1);\n      }\n      handlers.forEach((handler) => {\n        this.#addRoute(METHOD_NAME_ALL, this.#path, handler);\n      });\n      return this;\n    };\n    const { strict, ...optionsWithoutStrict } = options;\n    Object.assign(this, optionsWithoutStrict);\n    this.getPath = strict ?? true ? options.getPath ?? getPath : getPathNoStrict;\n  }\n  #clone() {\n    const clone = new _Hono({\n      router: this.router,\n      getPath: this.getPath\n    });\n    clone.errorHandler = this.errorHandler;\n    clone.#notFoundHandler = this.#notFoundHandler;\n    clone.routes = this.routes;\n    return clone;\n  }\n  #notFoundHandler = notFoundHandler;\n  // Cannot use `#` because it requires visibility at JavaScript runtime.\n  errorHandler = errorHandler;\n  /**\n   * `.route()` allows grouping other Hono instance in routes.\n   *\n   * @see {@link https://hono.dev/docs/api/routing#grouping}\n   *\n   * @param {string} path - base Path\n   * @param {Hono} app - other Hono instance\n   * @returns {Hono} routed Hono instance\n   *\n   * @example\n   * ```ts\n   * const app = new Hono()\n   * const app2 = new Hono()\n   *\n   * app2.get(\"/user\", (c) => c.text(\"user\"))\n   * app.route(\"/api\", app2) // GET /api/user\n   * ```\n   */\n  route(path, app) {\n    const subApp = this.basePath(path);\n    app.routes.map((r) => {\n      let handler;\n      if (app.errorHandler === errorHandler) {\n        handler = r.handler;\n      } else {\n        handler = async (c, next) => (await compose([], app.errorHandler)(c, () => r.handler(c, next))).res;\n        handler[COMPOSED_HANDLER] = r.handler;\n      }\n      subApp.#addRoute(r.method, r.path, handler);\n    });\n    return this;\n  }\n  /**\n   * `.basePath()` allows base paths to be specified.\n   *\n   * @see {@link https://hono.dev/docs/api/routing#base-path}\n   *\n   * @param {string} path - base Path\n   * @returns {Hono} changed Hono instance\n   *\n   * @example\n   * ```ts\n   * const api = new Hono().basePath('/api')\n   * ```\n   */\n  basePath(path) {\n    const subApp = this.#clone();\n    subApp._basePath = mergePath(this._basePath, path);\n    return subApp;\n  }\n  /**\n   * `.onError()` handles an error and returns a customized Response.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#error-handling}\n   *\n   * @param {ErrorHandler} handler - request Handler for error\n   * @returns {Hono} changed Hono instance\n   *\n   * @example\n   * ```ts\n   * app.onError((err, c) => {\n   *   console.error(`${err}`)\n   *   return c.text('Custom Error Message', 500)\n   * })\n   * ```\n   */\n  onError = (handler) => {\n    this.errorHandler = handler;\n    return this;\n  };\n  /**\n   * `.notFound()` allows you to customize a Not Found Response.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#not-found}\n   *\n   * @param {NotFoundHandler} handler - request handler for not-found\n   * @returns {Hono} changed Hono instance\n   *\n   * @example\n   * ```ts\n   * app.notFound((c) => {\n   *   return c.text('Custom 404 Message', 404)\n   * })\n   * ```\n   */\n  notFound = (handler) => {\n    this.#notFoundHandler = handler;\n    return this;\n  };\n  /**\n   * `.mount()` allows you to mount applications built with other frameworks into your Hono application.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#mount}\n   *\n   * @param {string} path - base Path\n   * @param {Function} applicationHandler - other Request Handler\n   * @param {MountOptions} [options] - options of `.mount()`\n   * @returns {Hono} mounted Hono instance\n   *\n   * @example\n   * ```ts\n   * import { Router as IttyRouter } from 'itty-router'\n   * import { Hono } from 'hono'\n   * // Create itty-router application\n   * const ittyRouter = IttyRouter()\n   * // GET /itty-router/hello\n   * ittyRouter.get('/hello', () => new Response('Hello from itty-router'))\n   *\n   * const app = new Hono()\n   * app.mount('/itty-router', ittyRouter.handle)\n   * ```\n   *\n   * @example\n   * ```ts\n   * const app = new Hono()\n   * // Send the request to another application without modification.\n   * app.mount('/app', anotherApp, {\n   *   replaceRequest: (req) => req,\n   * })\n   * ```\n   */\n  mount(path, applicationHandler, options) {\n    let replaceRequest;\n    let optionHandler;\n    if (options) {\n      if (typeof options === \"function\") {\n        optionHandler = options;\n      } else {\n        optionHandler = options.optionHandler;\n        if (options.replaceRequest === false) {\n          replaceRequest = (request) => request;\n        } else {\n          replaceRequest = options.replaceRequest;\n        }\n      }\n    }\n    const getOptions = optionHandler ? (c) => {\n      const options2 = optionHandler(c);\n      return Array.isArray(options2) ? options2 : [options2];\n    } : (c) => {\n      let executionContext = void 0;\n      try {\n        executionContext = c.executionCtx;\n      } catch {\n      }\n      return [c.env, executionContext];\n    };\n    replaceRequest ||= (() => {\n      const mergedPath = mergePath(this._basePath, path);\n      const pathPrefixLength = mergedPath === \"/\" ? 0 : mergedPath.length;\n      return (request) => {\n        const url = new URL(request.url);\n        url.pathname = url.pathname.slice(pathPrefixLength) || \"/\";\n        return new Request(url, request);\n      };\n    })();\n    const handler = async (c, next) => {\n      const res = await applicationHandler(replaceRequest(c.req.raw), ...getOptions(c));\n      if (res) {\n        return res;\n      }\n      await next();\n    };\n    this.#addRoute(METHOD_NAME_ALL, mergePath(path, \"*\"), handler);\n    return this;\n  }\n  #addRoute(method, path, handler) {\n    method = method.toUpperCase();\n    path = mergePath(this._basePath, path);\n    const r = { basePath: this._basePath, path, method, handler };\n    this.router.add(method, path, [handler, r]);\n    this.routes.push(r);\n  }\n  #handleError(err, c) {\n    if (err instanceof Error) {\n      return this.errorHandler(err, c);\n    }\n    throw err;\n  }\n  #dispatch(request, executionCtx, env, method) {\n    if (method === \"HEAD\") {\n      return (async () => new Response(null, await this.#dispatch(request, executionCtx, env, \"GET\")))();\n    }\n    const path = this.getPath(request, { env });\n    const matchResult = this.router.match(method, path);\n    const c = new Context(request, {\n      path,\n      matchResult,\n      env,\n      executionCtx,\n      notFoundHandler: this.#notFoundHandler\n    });\n    if (matchResult[0].length === 1) {\n      let res;\n      try {\n        res = matchResult[0][0][0][0](c, async () => {\n          c.res = await this.#notFoundHandler(c);\n        });\n      } catch (err) {\n        return this.#handleError(err, c);\n      }\n      return res instanceof Promise ? res.then(\n        (resolved) => resolved || (c.finalized ? c.res : this.#notFoundHandler(c))\n      ).catch((err) => this.#handleError(err, c)) : res ?? this.#notFoundHandler(c);\n    }\n    const composed = compose(matchResult[0], this.errorHandler, this.#notFoundHandler);\n    return (async () => {\n      try {\n        const context = await composed(c);\n        if (!context.finalized) {\n          throw new Error(\n            \"Context is not finalized. Did you forget to return a Response object or `await next()`?\"\n          );\n        }\n        return context.res;\n      } catch (err) {\n        return this.#handleError(err, c);\n      }\n    })();\n  }\n  /**\n   * `.fetch()` will be entry point of your app.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#fetch}\n   *\n   * @param {Request} request - request Object of request\n   * @param {Env} Env - env Object\n   * @param {ExecutionContext} - context of execution\n   * @returns {Response | Promise<Response>} response of request\n   *\n   */\n  fetch = (request, ...rest) => {\n    return this.#dispatch(request, rest[1], rest[0], request.method);\n  };\n  /**\n   * `.request()` is a useful method for testing.\n   * You can pass a URL or pathname to send a GET request.\n   * app will return a Response object.\n   * ```ts\n   * test('GET /hello is ok', async () => {\n   *   const res = await app.request('/hello')\n   *   expect(res.status).toBe(200)\n   * })\n   * ```\n   * @see https://hono.dev/docs/api/hono#request\n   */\n  request = (input, requestInit, Env, executionCtx) => {\n    if (input instanceof Request) {\n      return this.fetch(requestInit ? new Request(input, requestInit) : input, Env, executionCtx);\n    }\n    input = input.toString();\n    return this.fetch(\n      new Request(\n        /^https?:\\/\\//.test(input) ? input : `http://localhost${mergePath(\"/\", input)}`,\n        requestInit\n      ),\n      Env,\n      executionCtx\n    );\n  };\n  /**\n   * `.fire()` automatically adds a global fetch event listener.\n   * This can be useful for environments that adhere to the Service Worker API, such as non-ES module Cloudflare Workers.\n   * @deprecated\n   * Use `fire` from `hono/service-worker` instead.\n   * ```ts\n   * import { Hono } from 'hono'\n   * import { fire } from 'hono/service-worker'\n   *\n   * const app = new Hono()\n   * // ...\n   * fire(app)\n   * ```\n   * @see https://hono.dev/docs/api/hono#fire\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API\n   * @see https://developers.cloudflare.com/workers/reference/migrate-to-module-workers/\n   */\n  fire = () => {\n    addEventListener(\"fetch\", (event) => {\n      event.respondWith(this.#dispatch(event.request, event, void 0, event.request.method));\n    });\n  };\n};\nexport {\n  Hono as HonoBase\n};\n", "// src/router/reg-exp-router/matcher.ts\nimport { METHOD_NAME_ALL } from \"../../router.js\";\nvar emptyParam = [];\nfunction match(method, path) {\n  const matchers = this.buildAllMatchers();\n  const match2 = ((method2, path2) => {\n    const matcher = matchers[method2] || matchers[METHOD_NAME_ALL];\n    const staticMatch = matcher[2][path2];\n    if (staticMatch) {\n      return staticMatch;\n    }\n    const match3 = path2.match(matcher[0]);\n    if (!match3) {\n      return [[], emptyParam];\n    }\n    const index = match3.indexOf(\"\", 1);\n    return [matcher[1][index], match3];\n  });\n  this.match = match2;\n  return match2(method, path);\n}\nexport {\n  emptyParam,\n  match\n};\n", "// src/router/reg-exp-router/node.ts\nvar LABEL_REG_EXP_STR = \"[^/]+\";\nvar ONLY_WILDCARD_REG_EXP_STR = \".*\";\nvar TAIL_WILDCARD_REG_EXP_STR = \"(?:|/.*)\";\nvar PATH_ERROR = /* @__PURE__ */ Symbol();\nvar regExpMetaChars = new Set(\".\\\\+*[^]$()\");\nfunction compareKey(a, b) {\n  if (a.length === 1) {\n    return b.length === 1 ? a < b ? -1 : 1 : -1;\n  }\n  if (b.length === 1) {\n    return 1;\n  }\n  if (a === ONLY_WILDCARD_REG_EXP_STR || a === TAIL_WILDCARD_REG_EXP_STR) {\n    return 1;\n  } else if (b === ONLY_WILDCARD_REG_EXP_STR || b === TAIL_WILDCARD_REG_EXP_STR) {\n    return -1;\n  }\n  if (a === LABEL_REG_EXP_STR) {\n    return 1;\n  } else if (b === LABEL_REG_EXP_STR) {\n    return -1;\n  }\n  return a.length === b.length ? a < b ? -1 : 1 : b.length - a.length;\n}\nvar Node = class _Node {\n  #index;\n  #varIndex;\n  #children = /* @__PURE__ */ Object.create(null);\n  insert(tokens, index, paramMap, context, pathErrorCheckOnly) {\n    if (tokens.length === 0) {\n      if (this.#index !== void 0) {\n        throw PATH_ERROR;\n      }\n      if (pathErrorCheckOnly) {\n        return;\n      }\n      this.#index = index;\n      return;\n    }\n    const [token, ...restTokens] = tokens;\n    const pattern = token === \"*\" ? restTokens.length === 0 ? [\"\", \"\", ONLY_WILDCARD_REG_EXP_STR] : [\"\", \"\", LABEL_REG_EXP_STR] : token === \"/*\" ? [\"\", \"\", TAIL_WILDCARD_REG_EXP_STR] : token.match(/^\\:([^\\{\\}]+)(?:\\{(.+)\\})?$/);\n    let node;\n    if (pattern) {\n      const name = pattern[1];\n      let regexpStr = pattern[2] || LABEL_REG_EXP_STR;\n      if (name && pattern[2]) {\n        if (regexpStr === \".*\") {\n          throw PATH_ERROR;\n        }\n        regexpStr = regexpStr.replace(/^\\((?!\\?:)(?=[^)]+\\)$)/, \"(?:\");\n        if (/\\((?!\\?:)/.test(regexpStr)) {\n          throw PATH_ERROR;\n        }\n      }\n      node = this.#children[regexpStr];\n      if (!node) {\n        if (Object.keys(this.#children).some(\n          (k) => k !== ONLY_WILDCARD_REG_EXP_STR && k !== TAIL_WILDCARD_REG_EXP_STR\n        )) {\n          throw PATH_ERROR;\n        }\n        if (pathErrorCheckOnly) {\n          return;\n        }\n        node = this.#children[regexpStr] = new _Node();\n        if (name !== \"\") {\n          node.#varIndex = context.varIndex++;\n        }\n      }\n      if (!pathErrorCheckOnly && name !== \"\") {\n        paramMap.push([name, node.#varIndex]);\n      }\n    } else {\n      node = this.#children[token];\n      if (!node) {\n        if (Object.keys(this.#children).some(\n          (k) => k.length > 1 && k !== ONLY_WILDCARD_REG_EXP_STR && k !== TAIL_WILDCARD_REG_EXP_STR\n        )) {\n          throw PATH_ERROR;\n        }\n        if (pathErrorCheckOnly) {\n          return;\n        }\n        node = this.#children[token] = new _Node();\n      }\n    }\n    node.insert(restTokens, index, paramMap, context, pathErrorCheckOnly);\n  }\n  buildRegExpStr() {\n    const childKeys = Object.keys(this.#children).sort(compareKey);\n    const strList = childKeys.map((k) => {\n      const c = this.#children[k];\n      return (typeof c.#varIndex === \"number\" ? `(${k})@${c.#varIndex}` : regExpMetaChars.has(k) ? `\\\\${k}` : k) + c.buildRegExpStr();\n    });\n    if (typeof this.#index === \"number\") {\n      strList.unshift(`#${this.#index}`);\n    }\n    if (strList.length === 0) {\n      return \"\";\n    }\n    if (strList.length === 1) {\n      return strList[0];\n    }\n    return \"(?:\" + strList.join(\"|\") + \")\";\n  }\n};\nexport {\n  Node,\n  PATH_ERROR\n};\n", "// src/router/reg-exp-router/trie.ts\nimport { Node } from \"./node.js\";\nvar Trie = class {\n  #context = { varIndex: 0 };\n  #root = new Node();\n  insert(path, index, pathErrorCheckOnly) {\n    const paramAssoc = [];\n    const groups = [];\n    for (let i = 0; ; ) {\n      let replaced = false;\n      path = path.replace(/\\{[^}]+\\}/g, (m) => {\n        const mark = `@\\\\${i}`;\n        groups[i] = [mark, m];\n        i++;\n        replaced = true;\n        return mark;\n      });\n      if (!replaced) {\n        break;\n      }\n    }\n    const tokens = path.match(/(?::[^\\/]+)|(?:\\/\\*$)|./g) || [];\n    for (let i = groups.length - 1; i >= 0; i--) {\n      const [mark] = groups[i];\n      for (let j = tokens.length - 1; j >= 0; j--) {\n        if (tokens[j].indexOf(mark) !== -1) {\n          tokens[j] = tokens[j].replace(mark, groups[i][1]);\n          break;\n        }\n      }\n    }\n    this.#root.insert(tokens, index, paramAssoc, this.#context, pathErrorCheckOnly);\n    return paramAssoc;\n  }\n  buildRegExp() {\n    let regexp = this.#root.buildRegExpStr();\n    if (regexp === \"\") {\n      return [/^$/, [], []];\n    }\n    let captureIndex = 0;\n    const indexReplacementMap = [];\n    const paramReplacementMap = [];\n    regexp = regexp.replace(/#(\\d+)|@(\\d+)|\\.\\*\\$/g, (_, handlerIndex, paramIndex) => {\n      if (handlerIndex !== void 0) {\n        indexReplacementMap[++captureIndex] = Number(handlerIndex);\n        return \"$()\";\n      }\n      if (paramIndex !== void 0) {\n        paramReplacementMap[Number(paramIndex)] = ++captureIndex;\n        return \"\";\n      }\n      return \"\";\n    });\n    return [new RegExp(`^${regexp}`), indexReplacementMap, paramReplacementMap];\n  }\n};\nexport {\n  Trie\n};\n", "// src/router/reg-exp-router/router.ts\nimport {\n  MESSAGE_MATCHER_IS_ALREADY_BUILT,\n  METHOD_NAME_ALL,\n  UnsupportedPathError\n} from \"../../router.js\";\nimport { checkOptionalParameter } from \"../../utils/url.js\";\nimport { match, emptyParam } from \"./matcher.js\";\nimport { PATH_ERROR } from \"./node.js\";\nimport { Trie } from \"./trie.js\";\nvar nullMatcher = [/^$/, [], /* @__PURE__ */ Object.create(null)];\nvar wildcardRegExpCache = /* @__PURE__ */ Object.create(null);\nfunction buildWildcardRegExp(path) {\n  return wildcardRegExpCache[path] ??= new RegExp(\n    path === \"*\" ? \"\" : `^${path.replace(\n      /\\/\\*$|([.\\\\+*[^\\]$()])/g,\n      (_, metaChar) => metaChar ? `\\\\${metaChar}` : \"(?:|/.*)\"\n    )}$`\n  );\n}\nfunction clearWildcardRegExpCache() {\n  wildcardRegExpCache = /* @__PURE__ */ Object.create(null);\n}\nfunction buildMatcherFromPreprocessedRoutes(routes) {\n  const trie = new Trie();\n  const handlerData = [];\n  if (routes.length === 0) {\n    return nullMatcher;\n  }\n  const routesWithStaticPathFlag = routes.map(\n    (route) => [!/\\*|\\/:/.test(route[0]), ...route]\n  ).sort(\n    ([isStaticA, pathA], [isStaticB, pathB]) => isStaticA ? 1 : isStaticB ? -1 : pathA.length - pathB.length\n  );\n  const staticMap = /* @__PURE__ */ Object.create(null);\n  for (let i = 0, j = -1, len = routesWithStaticPathFlag.length; i < len; i++) {\n    const [pathErrorCheckOnly, path, handlers] = routesWithStaticPathFlag[i];\n    if (pathErrorCheckOnly) {\n      staticMap[path] = [handlers.map(([h]) => [h, /* @__PURE__ */ Object.create(null)]), emptyParam];\n    } else {\n      j++;\n    }\n    let paramAssoc;\n    try {\n      paramAssoc = trie.insert(path, j, pathErrorCheckOnly);\n    } catch (e) {\n      throw e === PATH_ERROR ? new UnsupportedPathError(path) : e;\n    }\n    if (pathErrorCheckOnly) {\n      continue;\n    }\n    handlerData[j] = handlers.map(([h, paramCount]) => {\n      const paramIndexMap = /* @__PURE__ */ Object.create(null);\n      paramCount -= 1;\n      for (; paramCount >= 0; paramCount--) {\n        const [key, value] = paramAssoc[paramCount];\n        paramIndexMap[key] = value;\n      }\n      return [h, paramIndexMap];\n    });\n  }\n  const [regexp, indexReplacementMap, paramReplacementMap] = trie.buildRegExp();\n  for (let i = 0, len = handlerData.length; i < len; i++) {\n    for (let j = 0, len2 = handlerData[i].length; j < len2; j++) {\n      const map = handlerData[i][j]?.[1];\n      if (!map) {\n        continue;\n      }\n      const keys = Object.keys(map);\n      for (let k = 0, len3 = keys.length; k < len3; k++) {\n        map[keys[k]] = paramReplacementMap[map[keys[k]]];\n      }\n    }\n  }\n  const handlerMap = [];\n  for (const i in indexReplacementMap) {\n    handlerMap[i] = handlerData[indexReplacementMap[i]];\n  }\n  return [regexp, handlerMap, staticMap];\n}\nfunction findMiddleware(middleware, path) {\n  if (!middleware) {\n    return void 0;\n  }\n  for (const k of Object.keys(middleware).sort((a, b) => b.length - a.length)) {\n    if (buildWildcardRegExp(k).test(path)) {\n      return [...middleware[k]];\n    }\n  }\n  return void 0;\n}\nvar RegExpRouter = class {\n  name = \"RegExpRouter\";\n  #middleware;\n  #routes;\n  constructor() {\n    this.#middleware = { [METHOD_NAME_ALL]: /* @__PURE__ */ Object.create(null) };\n    this.#routes = { [METHOD_NAME_ALL]: /* @__PURE__ */ Object.create(null) };\n  }\n  add(method, path, handler) {\n    const middleware = this.#middleware;\n    const routes = this.#routes;\n    if (!middleware || !routes) {\n      throw new Error(MESSAGE_MATCHER_IS_ALREADY_BUILT);\n    }\n    if (!middleware[method]) {\n      ;\n      [middleware, routes].forEach((handlerMap) => {\n        handlerMap[method] = /* @__PURE__ */ Object.create(null);\n        Object.keys(handlerMap[METHOD_NAME_ALL]).forEach((p) => {\n          handlerMap[method][p] = [...handlerMap[METHOD_NAME_ALL][p]];\n        });\n      });\n    }\n    if (path === \"/*\") {\n      path = \"*\";\n    }\n    const paramCount = (path.match(/\\/:/g) || []).length;\n    if (/\\*$/.test(path)) {\n      const re = buildWildcardRegExp(path);\n      if (method === METHOD_NAME_ALL) {\n        Object.keys(middleware).forEach((m) => {\n          middleware[m][path] ||= findMiddleware(middleware[m], path) || findMiddleware(middleware[METHOD_NAME_ALL], path) || [];\n        });\n      } else {\n        middleware[method][path] ||= findMiddleware(middleware[method], path) || findMiddleware(middleware[METHOD_NAME_ALL], path) || [];\n      }\n      Object.keys(middleware).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          Object.keys(middleware[m]).forEach((p) => {\n            re.test(p) && middleware[m][p].push([handler, paramCount]);\n          });\n        }\n      });\n      Object.keys(routes).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          Object.keys(routes[m]).forEach(\n            (p) => re.test(p) && routes[m][p].push([handler, paramCount])\n          );\n        }\n      });\n      return;\n    }\n    const paths = checkOptionalParameter(path) || [path];\n    for (let i = 0, len = paths.length; i < len; i++) {\n      const path2 = paths[i];\n      Object.keys(routes).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          routes[m][path2] ||= [\n            ...findMiddleware(middleware[m], path2) || findMiddleware(middleware[METHOD_NAME_ALL], path2) || []\n          ];\n          routes[m][path2].push([handler, paramCount - len + i + 1]);\n        }\n      });\n    }\n  }\n  match = match;\n  buildAllMatchers() {\n    const matchers = /* @__PURE__ */ Object.create(null);\n    Object.keys(this.#routes).concat(Object.keys(this.#middleware)).forEach((method) => {\n      matchers[method] ||= this.#buildMatcher(method);\n    });\n    this.#middleware = this.#routes = void 0;\n    clearWildcardRegExpCache();\n    return matchers;\n  }\n  #buildMatcher(method) {\n    const routes = [];\n    let hasOwnRoute = method === METHOD_NAME_ALL;\n    [this.#middleware, this.#routes].forEach((r) => {\n      const ownRoute = r[method] ? Object.keys(r[method]).map((path) => [path, r[method][path]]) : [];\n      if (ownRoute.length !== 0) {\n        hasOwnRoute ||= true;\n        routes.push(...ownRoute);\n      } else if (method !== METHOD_NAME_ALL) {\n        routes.push(\n          ...Object.keys(r[METHOD_NAME_ALL]).map((path) => [path, r[METHOD_NAME_ALL][path]])\n        );\n      }\n    });\n    if (!hasOwnRoute) {\n      return null;\n    } else {\n      return buildMatcherFromPreprocessedRoutes(routes);\n    }\n  }\n};\nexport {\n  RegExpRouter\n};\n", "// src/router/smart-router/router.ts\nimport { MESSAGE_MATCHER_IS_ALREADY_BUILT, UnsupportedPathError } from \"../../router.js\";\nvar SmartRouter = class {\n  name = \"SmartRouter\";\n  #routers = [];\n  #routes = [];\n  constructor(init) {\n    this.#routers = init.routers;\n  }\n  add(method, path, handler) {\n    if (!this.#routes) {\n      throw new Error(MESSAGE_MATCHER_IS_ALREADY_BUILT);\n    }\n    this.#routes.push([method, path, handler]);\n  }\n  match(method, path) {\n    if (!this.#routes) {\n      throw new Error(\"Fatal error\");\n    }\n    const routers = this.#routers;\n    const routes = this.#routes;\n    const len = routers.length;\n    let i = 0;\n    let res;\n    for (; i < len; i++) {\n      const router = routers[i];\n      try {\n        for (let i2 = 0, len2 = routes.length; i2 < len2; i2++) {\n          router.add(...routes[i2]);\n        }\n        res = router.match(method, path);\n      } catch (e) {\n        if (e instanceof UnsupportedPathError) {\n          continue;\n        }\n        throw e;\n      }\n      this.match = router.match.bind(router);\n      this.#routers = [router];\n      this.#routes = void 0;\n      break;\n    }\n    if (i === len) {\n      throw new Error(\"Fatal error\");\n    }\n    this.name = `SmartRouter + ${this.activeRouter.name}`;\n    return res;\n  }\n  get activeRouter() {\n    if (this.#routes || this.#routers.length !== 1) {\n      throw new Error(\"No active router has been determined yet.\");\n    }\n    return this.#routers[0];\n  }\n};\nexport {\n  SmartRouter\n};\n", "// src/router/trie-router/node.ts\nimport { METHOD_NAME_ALL } from \"../../router.js\";\nimport { getPattern, splitPath, splitRoutingPath } from \"../../utils/url.js\";\nvar emptyParams = /* @__PURE__ */ Object.create(null);\nvar Node = class _Node {\n  #methods;\n  #children;\n  #patterns;\n  #order = 0;\n  #params = emptyParams;\n  constructor(method, handler, children) {\n    this.#children = children || /* @__PURE__ */ Object.create(null);\n    this.#methods = [];\n    if (method && handler) {\n      const m = /* @__PURE__ */ Object.create(null);\n      m[method] = { handler, possibleKeys: [], score: 0 };\n      this.#methods = [m];\n    }\n    this.#patterns = [];\n  }\n  insert(method, path, handler) {\n    this.#order = ++this.#order;\n    let curNode = this;\n    const parts = splitRoutingPath(path);\n    const possibleKeys = [];\n    for (let i = 0, len = parts.length; i < len; i++) {\n      const p = parts[i];\n      const nextP = parts[i + 1];\n      const pattern = getPattern(p, nextP);\n      const key = Array.isArray(pattern) ? pattern[0] : p;\n      if (key in curNode.#children) {\n        curNode = curNode.#children[key];\n        if (pattern) {\n          possibleKeys.push(pattern[1]);\n        }\n        continue;\n      }\n      curNode.#children[key] = new _Node();\n      if (pattern) {\n        curNode.#patterns.push(pattern);\n        possibleKeys.push(pattern[1]);\n      }\n      curNode = curNode.#children[key];\n    }\n    curNode.#methods.push({\n      [method]: {\n        handler,\n        possibleKeys: possibleKeys.filter((v, i, a) => a.indexOf(v) === i),\n        score: this.#order\n      }\n    });\n    return curNode;\n  }\n  #getHandlerSets(node, method, nodeParams, params) {\n    const handlerSets = [];\n    for (let i = 0, len = node.#methods.length; i < len; i++) {\n      const m = node.#methods[i];\n      const handlerSet = m[method] || m[METHOD_NAME_ALL];\n      const processedSet = {};\n      if (handlerSet !== void 0) {\n        handlerSet.params = /* @__PURE__ */ Object.create(null);\n        handlerSets.push(handlerSet);\n        if (nodeParams !== emptyParams || params && params !== emptyParams) {\n          for (let i2 = 0, len2 = handlerSet.possibleKeys.length; i2 < len2; i2++) {\n            const key = handlerSet.possibleKeys[i2];\n            const processed = processedSet[handlerSet.score];\n            handlerSet.params[key] = params?.[key] && !processed ? params[key] : nodeParams[key] ?? params?.[key];\n            processedSet[handlerSet.score] = true;\n          }\n        }\n      }\n    }\n    return handlerSets;\n  }\n  search(method, path) {\n    const handlerSets = [];\n    this.#params = emptyParams;\n    const curNode = this;\n    let curNodes = [curNode];\n    const parts = splitPath(path);\n    const curNodesQueue = [];\n    for (let i = 0, len = parts.length; i < len; i++) {\n      const part = parts[i];\n      const isLast = i === len - 1;\n      const tempNodes = [];\n      for (let j = 0, len2 = curNodes.length; j < len2; j++) {\n        const node = curNodes[j];\n        const nextNode = node.#children[part];\n        if (nextNode) {\n          nextNode.#params = node.#params;\n          if (isLast) {\n            if (nextNode.#children[\"*\"]) {\n              handlerSets.push(\n                ...this.#getHandlerSets(nextNode.#children[\"*\"], method, node.#params)\n              );\n            }\n            handlerSets.push(...this.#getHandlerSets(nextNode, method, node.#params));\n          } else {\n            tempNodes.push(nextNode);\n          }\n        }\n        for (let k = 0, len3 = node.#patterns.length; k < len3; k++) {\n          const pattern = node.#patterns[k];\n          const params = node.#params === emptyParams ? {} : { ...node.#params };\n          if (pattern === \"*\") {\n            const astNode = node.#children[\"*\"];\n            if (astNode) {\n              handlerSets.push(...this.#getHandlerSets(astNode, method, node.#params));\n              astNode.#params = params;\n              tempNodes.push(astNode);\n            }\n            continue;\n          }\n          const [key, name, matcher] = pattern;\n          if (!part && !(matcher instanceof RegExp)) {\n            continue;\n          }\n          const child = node.#children[key];\n          const restPathString = parts.slice(i).join(\"/\");\n          if (matcher instanceof RegExp) {\n            const m = matcher.exec(restPathString);\n            if (m) {\n              params[name] = m[0];\n              handlerSets.push(...this.#getHandlerSets(child, method, node.#params, params));\n              if (Object.keys(child.#children).length) {\n                child.#params = params;\n                const componentCount = m[0].match(/\\//)?.length ?? 0;\n                const targetCurNodes = curNodesQueue[componentCount] ||= [];\n                targetCurNodes.push(child);\n              }\n              continue;\n            }\n          }\n          if (matcher === true || matcher.test(part)) {\n            params[name] = part;\n            if (isLast) {\n              handlerSets.push(...this.#getHandlerSets(child, method, params, node.#params));\n              if (child.#children[\"*\"]) {\n                handlerSets.push(\n                  ...this.#getHandlerSets(child.#children[\"*\"], method, params, node.#params)\n                );\n              }\n            } else {\n              child.#params = params;\n              tempNodes.push(child);\n            }\n          }\n        }\n      }\n      curNodes = tempNodes.concat(curNodesQueue.shift() ?? []);\n    }\n    if (handlerSets.length > 1) {\n      handlerSets.sort((a, b) => {\n        return a.score - b.score;\n      });\n    }\n    return [handlerSets.map(({ handler, params }) => [handler, params])];\n  }\n};\nexport {\n  Node\n};\n", "// src/router/trie-router/router.ts\nimport { checkOptionalParameter } from \"../../utils/url.js\";\nimport { Node } from \"./node.js\";\nvar TrieRouter = class {\n  name = \"TrieRouter\";\n  #node;\n  constructor() {\n    this.#node = new Node();\n  }\n  add(method, path, handler) {\n    const results = checkOptionalParameter(path);\n    if (results) {\n      for (let i = 0, len = results.length; i < len; i++) {\n        this.#node.insert(method, results[i], handler);\n      }\n      return;\n    }\n    this.#node.insert(method, path, handler);\n  }\n  match(method, path) {\n    return this.#node.search(method, path);\n  }\n};\nexport {\n  TrieRouter\n};\n", "// src/hono.ts\nimport { HonoBase } from \"./hono-base.js\";\nimport { RegExpRouter } from \"./router/reg-exp-router/index.js\";\nimport { SmartRouter } from \"./router/smart-router/index.js\";\nimport { TrieRouter } from \"./router/trie-router/index.js\";\nvar Hono = class extends HonoBase {\n  /**\n   * Creates an instance of the Hono class.\n   *\n   * @param options - Optional configuration options for the Hono instance.\n   */\n  constructor(options = {}) {\n    super(options);\n    this.router = options.router ?? new SmartRouter({\n      routers: [new RegExpRouter(), new TrieRouter()]\n    });\n  }\n};\nexport {\n  Hono\n};\n", "// src/middleware/cors/index.ts\nvar cors = (options) => {\n  const defaults = {\n    origin: \"*\",\n    allowMethods: [\"GET\", \"HEAD\", \"PUT\", \"POST\", \"DELETE\", \"PATCH\"],\n    allowHeaders: [],\n    exposeHeaders: []\n  };\n  const opts = {\n    ...defaults,\n    ...options\n  };\n  const findAllowOrigin = ((optsOrigin) => {\n    if (typeof optsOrigin === \"string\") {\n      if (optsOrigin === \"*\") {\n        return () => optsOrigin;\n      } else {\n        return (origin) => optsOrigin === origin ? origin : null;\n      }\n    } else if (typeof optsOrigin === \"function\") {\n      return optsOrigin;\n    } else {\n      return (origin) => optsOrigin.includes(origin) ? origin : null;\n    }\n  })(opts.origin);\n  const findAllowMethods = ((optsAllowMethods) => {\n    if (typeof optsAllowMethods === \"function\") {\n      return optsAllowMethods;\n    } else if (Array.isArray(optsAllowMethods)) {\n      return () => optsAllowMethods;\n    } else {\n      return () => [];\n    }\n  })(opts.allowMethods);\n  return async function cors2(c, next) {\n    function set(key, value) {\n      c.res.headers.set(key, value);\n    }\n    const allowOrigin = await findAllowOrigin(c.req.header(\"origin\") || \"\", c);\n    if (allowOrigin) {\n      set(\"Access-Control-Allow-Origin\", allowOrigin);\n    }\n    if (opts.credentials) {\n      set(\"Access-Control-Allow-Credentials\", \"true\");\n    }\n    if (opts.exposeHeaders?.length) {\n      set(\"Access-Control-Expose-Headers\", opts.exposeHeaders.join(\",\"));\n    }\n    if (c.req.method === \"OPTIONS\") {\n      if (opts.origin !== \"*\") {\n        set(\"Vary\", \"Origin\");\n      }\n      if (opts.maxAge != null) {\n        set(\"Access-Control-Max-Age\", opts.maxAge.toString());\n      }\n      const allowMethods = await findAllowMethods(c.req.header(\"origin\") || \"\", c);\n      if (allowMethods.length) {\n        set(\"Access-Control-Allow-Methods\", allowMethods.join(\",\"));\n      }\n      let headers = opts.allowHeaders;\n      if (!headers?.length) {\n        const requestHeaders = c.req.header(\"Access-Control-Request-Headers\");\n        if (requestHeaders) {\n          headers = requestHeaders.split(/\\s*,\\s*/);\n        }\n      }\n      if (headers?.length) {\n        set(\"Access-Control-Allow-Headers\", headers.join(\",\"));\n        c.res.headers.append(\"Vary\", \"Access-Control-Request-Headers\");\n      }\n      c.res.headers.delete(\"Content-Length\");\n      c.res.headers.delete(\"Content-Type\");\n      return new Response(null, {\n        headers: c.res.headers,\n        status: 204,\n        statusText: \"No Content\"\n      });\n    }\n    await next();\n    if (opts.origin !== \"*\") {\n      c.header(\"Vary\", \"Origin\", { append: true });\n    }\n  };\n};\nexport {\n  cors\n};\n", "/**\n * Registry routes - Register and discover x402 endpoints\n */\n\nimport { Hono } from \"hono\";\nimport type { Endpoint, RegistryEnv } from \"../types\";\n\nexport const registry = new Hono<{ Bindings: RegistryEnv }>();\n\n// In-memory store for PoC (replace with D1 in production)\nconst endpoints = new Map<string, Endpoint>();\n\n// Register a new endpoint\nregistry.post(\"/register\", async (c) => {\n  const body = await c.req.json();\n\n  const { url, name, description, owner, price, token, tags, category, openApiSpec } = body;\n\n  // Validate required fields\n  if (!url || !name || !owner || price === undefined || !token) {\n    return c.json({ error: \"Missing required fields: url, name, owner, price, token\" }, 400);\n  }\n\n  // Verify the endpoint is x402 compliant\n  const verification = await verifyX402Endpoint(url);\n  if (!verification.valid) {\n    return c.json({\n      error: \"Endpoint is not x402 compliant\",\n      details: verification.error,\n      help: \"Your endpoint must return 402 with payment requirements\",\n    }, 400);\n  }\n\n  const id = generateId();\n  const endpoint: Endpoint = {\n    id,\n    url,\n    name,\n    description: description || \"\",\n    owner,\n    price,\n    token,\n    tags: tags || [],\n    category: category || \"utility\",\n    openApiSpec,\n    verified: verification.valid,\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    stats: {\n      totalCalls: 0,\n      calls24h: 0,\n      revenue24h: 0,\n      avgResponseTime: verification.responseTime || 0,\n      uptime: 100,\n      lastChecked: new Date().toISOString(),\n    },\n  };\n\n  endpoints.set(id, endpoint);\n\n  return c.json({\n    success: true,\n    endpoint: {\n      id: endpoint.id,\n      url: endpoint.url,\n      name: endpoint.name,\n      verified: endpoint.verified,\n      registryUrl: `https://x402.registry/endpoint/${id}`,\n    },\n    message: \"Endpoint registered successfully! It will appear in search results.\",\n  }, 201);\n});\n\n// Search endpoints\nregistry.get(\"/search\", (c) => {\n  const tag = c.req.query(\"tag\");\n  const category = c.req.query(\"category\");\n  const token = c.req.query(\"token\");\n  const q = c.req.query(\"q\");\n  const limit = parseInt(c.req.query(\"limit\") || \"20\");\n  const offset = parseInt(c.req.query(\"offset\") || \"0\");\n\n  let results = Array.from(endpoints.values());\n\n  // Filter by tag\n  if (tag) {\n    results = results.filter((e) => e.tags.includes(tag));\n  }\n\n  // Filter by category\n  if (category) {\n    results = results.filter((e) => e.category === category);\n  }\n\n  // Filter by token\n  if (token) {\n    results = results.filter((e) => e.token === token);\n  }\n\n  // Search query\n  if (q) {\n    const query = q.toLowerCase();\n    results = results.filter(\n      (e) =>\n        e.name.toLowerCase().includes(query) ||\n        e.description.toLowerCase().includes(query) ||\n        e.tags.some((t) => t.toLowerCase().includes(query))\n    );\n  }\n\n  // Sort by popularity (calls24h)\n  results.sort((a, b) => b.stats.calls24h - a.stats.calls24h);\n\n  // Paginate\n  const total = results.length;\n  results = results.slice(offset, offset + limit);\n\n  return c.json({\n    results: results.map(summarizeEndpoint),\n    total,\n    limit,\n    offset,\n    hasMore: offset + limit < total,\n  });\n});\n\n// Discover trending/featured endpoints\nregistry.get(\"/discover\", (c) => {\n  const allEndpoints = Array.from(endpoints.values());\n\n  // Trending: most calls in 24h\n  const trending = [...allEndpoints]\n    .sort((a, b) => b.stats.calls24h - a.stats.calls24h)\n    .slice(0, 10);\n\n  // New: recently added\n  const newest = [...allEndpoints]\n    .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())\n    .slice(0, 10);\n\n  // By category\n  const categories = new Map<string, Endpoint[]>();\n  allEndpoints.forEach((e) => {\n    const cat = categories.get(e.category) || [];\n    cat.push(e);\n    categories.set(e.category, cat);\n  });\n\n  const byCategory: Record<string, any[]> = {};\n  categories.forEach((eps, cat) => {\n    byCategory[cat] = eps.slice(0, 5).map(summarizeEndpoint);\n  });\n\n  return c.json({\n    trending: trending.map(summarizeEndpoint),\n    new: newest.map(summarizeEndpoint),\n    byCategory,\n    totalEndpoints: allEndpoints.length,\n    categories: Array.from(categories.keys()),\n  });\n});\n\n// Get endpoint details\nregistry.get(\"/:id\", (c) => {\n  const id = c.req.param(\"id\");\n  const endpoint = endpoints.get(id);\n\n  if (!endpoint) {\n    return c.json({ error: \"Endpoint not found\" }, 404);\n  }\n\n  return c.json(endpoint);\n});\n\n// Get endpoint stats\nregistry.get(\"/:id/stats\", (c) => {\n  const id = c.req.param(\"id\");\n  const endpoint = endpoints.get(id);\n\n  if (!endpoint) {\n    return c.json({ error: \"Endpoint not found\" }, 404);\n  }\n\n  return c.json({\n    endpointId: id,\n    name: endpoint.name,\n    stats: endpoint.stats,\n    pricing: {\n      price: endpoint.price,\n      token: endpoint.token,\n    },\n  });\n});\n\n// Delete endpoint (owner only)\nregistry.delete(\"/:id\", async (c) => {\n  const id = c.req.param(\"id\");\n  const owner = c.req.header(\"X-Owner-Address\");\n\n  const endpoint = endpoints.get(id);\n\n  if (!endpoint) {\n    return c.json({ error: \"Endpoint not found\" }, 404);\n  }\n\n  if (endpoint.owner !== owner) {\n    return c.json({ error: \"Not authorized\" }, 403);\n  }\n\n  endpoints.delete(id);\n\n  return c.json({ success: true, message: \"Endpoint removed\" });\n});\n\n// Update endpoint\nregistry.put(\"/:id\", async (c) => {\n  const id = c.req.param(\"id\");\n  const owner = c.req.header(\"X-Owner-Address\");\n  const updates = await c.req.json();\n\n  const endpoint = endpoints.get(id);\n\n  if (!endpoint) {\n    return c.json({ error: \"Endpoint not found\" }, 404);\n  }\n\n  if (endpoint.owner !== owner) {\n    return c.json({ error: \"Not authorized\" }, 403);\n  }\n\n  // Only allow updating certain fields\n  const allowedUpdates = [\"name\", \"description\", \"price\", \"tags\", \"category\", \"openApiSpec\"];\n  for (const key of allowedUpdates) {\n    if (updates[key] !== undefined) {\n      (endpoint as any)[key] = updates[key];\n    }\n  }\n  endpoint.updatedAt = new Date().toISOString();\n\n  endpoints.set(id, endpoint);\n\n  return c.json({ success: true, endpoint: summarizeEndpoint(endpoint) });\n});\n\n// Helper functions\n\nasync function verifyX402Endpoint(url: string): Promise<{ valid: boolean; error?: string; responseTime?: number }> {\n  try {\n    const start = Date.now();\n    const response = await fetch(url, {\n      method: \"GET\",\n      headers: { Accept: \"application/json\" },\n    });\n    const responseTime = Date.now() - start;\n\n    // Should return 402 Payment Required\n    if (response.status === 402) {\n      const body = await response.json().catch(() => ({}));\n\n      // Check for required x402 fields\n      if (body.maxAmountRequired || body.amount || body.payTo || body.payment) {\n        return { valid: true, responseTime };\n      }\n\n      return {\n        valid: false,\n        error: \"402 response missing payment requirements (maxAmountRequired, payTo)\",\n        responseTime,\n      };\n    }\n\n    // Some endpoints might be GET with query params that make it paid\n    // Accept 200 if they claim to be x402\n    if (response.status === 200) {\n      return {\n        valid: true,\n        responseTime,\n      };\n    }\n\n    return {\n      valid: false,\n      error: `Expected 402 status, got ${response.status}`,\n      responseTime,\n    };\n  } catch (error: any) {\n    return {\n      valid: false,\n      error: `Failed to reach endpoint: ${error.message}`,\n    };\n  }\n}\n\nfunction generateId(): string {\n  return Math.random().toString(36).substring(2, 15);\n}\n\nfunction summarizeEndpoint(e: Endpoint) {\n  return {\n    id: e.id,\n    url: e.url,\n    name: e.name,\n    description: e.description,\n    price: e.price,\n    token: e.token,\n    tags: e.tags,\n    category: e.category,\n    verified: e.verified,\n    calls24h: e.stats.calls24h,\n    uptime: e.stats.uptime,\n  };\n}\n", "/**\n * Agent routes - AI agent discovery and orchestration\n *\n * This is the killer feature: agents can discover other agents,\n * compose them, and execute complex tasks across multiple services.\n */\n\nimport { Hono } from \"hono\";\nimport type { Agent, ExecutionRequest, ExecutionResult, RegistryEnv } from \"../types\";\n\nexport const agents = new Hono<{ Bindings: RegistryEnv }>();\n\n// In-memory store for PoC\nconst agentRegistry = new Map<string, Agent>();\n\n// Capability index for fast lookup\nconst capabilityIndex = new Map<string, Set<string>>(); // capability -> agent IDs\n\n// What can agents do?\nagents.get(\"/capabilities\", (c) => {\n  const allCapabilities = Array.from(capabilityIndex.keys()).sort();\n\n  const capabilityDetails = allCapabilities.map((cap) => {\n    const agentIds = capabilityIndex.get(cap) || new Set();\n    return {\n      capability: cap,\n      agentCount: agentIds.size,\n      description: getCapabilityDescription(cap),\n    };\n  });\n\n  return c.json({\n    totalCapabilities: allCapabilities.length,\n    totalAgents: agentRegistry.size,\n    capabilities: capabilityDetails,\n    categories: [\n      { name: \"ai\", description: \"AI/ML services (summarization, generation, analysis)\" },\n      { name: \"blockchain\", description: \"Blockchain queries and transactions\" },\n      { name: \"data\", description: \"Data transformation and processing\" },\n      { name: \"web\", description: \"Web scraping and API calls\" },\n      { name: \"media\", description: \"Image, audio, video processing\" },\n      { name: \"finance\", description: \"Pricing, payments, trading\" },\n    ],\n  });\n});\n\n// Find agents for a task\nagents.post(\"/recommend\", async (c) => {\n  const body = await c.req.json();\n  const { task, budget, token, capabilities } = body;\n\n  if (!task) {\n    return c.json({ error: \"Task description required\" }, 400);\n  }\n\n  // Extract capabilities needed from task description\n  const neededCapabilities = capabilities || inferCapabilities(task);\n\n  // Find agents that match\n  const matchingAgents: { agent: Agent; score: number; matchedCapabilities: string[] }[] = [];\n\n  agentRegistry.forEach((agent) => {\n    const matched = agent.capabilities.filter((cap) => neededCapabilities.includes(cap));\n    if (matched.length > 0) {\n      matchingAgents.push({\n        agent,\n        score: matched.length / neededCapabilities.length,\n        matchedCapabilities: matched,\n      });\n    }\n  });\n\n  // Sort by score and filter by budget if provided\n  matchingAgents.sort((a, b) => b.score - a.score);\n\n  const recommendations = matchingAgents\n    .filter((m) => !budget || m.agent.pricing.basePrice <= budget)\n    .map((m) => ({\n      id: m.agent.id,\n      name: m.agent.name,\n      description: m.agent.description,\n      matchScore: Math.round(m.score * 100),\n      matchedCapabilities: m.matchedCapabilities,\n      pricing: m.agent.pricing,\n    }));\n\n  // Build an execution plan if we have multiple agents\n  const executionPlan = buildExecutionPlan(task, recommendations);\n\n  return c.json({\n    task,\n    inferredCapabilities: neededCapabilities,\n    recommendations: recommendations.slice(0, 10),\n    executionPlan,\n    estimatedCost: executionPlan.totalCost,\n  });\n});\n\n// Get agent's OpenAPI spec (machine-readable)\nagents.get(\"/:id/openapi\", (c) => {\n  const id = c.req.param(\"id\");\n  const agent = agentRegistry.get(id);\n\n  if (!agent) {\n    return c.json({ error: \"Agent not found\" }, 404);\n  }\n\n  // Generate OpenAPI spec for this agent\n  const spec = {\n    openapi: \"3.0.0\",\n    info: {\n      title: agent.name,\n      description: agent.description,\n      version: \"1.0.0\",\n    },\n    servers: [{ url: \"https://x402.registry/agents\" }],\n    paths: {\n      [`/${agent.id}/execute`]: {\n        post: {\n          summary: `Execute ${agent.name}`,\n          description: agent.description,\n          requestBody: {\n            required: true,\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    task: { type: \"string\" },\n                    params: { type: \"object\" },\n                  },\n                },\n              },\n            },\n          },\n          responses: {\n            \"200\": { description: \"Successful execution\" },\n            \"402\": { description: \"Payment required\" },\n          },\n        },\n      },\n    },\n    \"x-capabilities\": agent.capabilities,\n    \"x-pricing\": agent.pricing,\n    \"x-payment\": {\n      required: true,\n      token: agent.pricing.token,\n      amount: agent.pricing.basePrice,\n    },\n  };\n\n  return c.json(spec);\n});\n\n// Execute a task (the killer feature)\nagents.post(\"/execute\", async (c) => {\n  const body = await c.req.json() as ExecutionRequest;\n  const { task, budget, token, preferredAgents, timeout } = body;\n\n  if (!task || !budget || !token) {\n    return c.json({ error: \"Required: task, budget, token\" }, 400);\n  }\n\n  // Check payment\n  const paymentProof = c.req.header(\"X-Payment-Proof\");\n  if (!paymentProof) {\n    // Return 402 with payment requirements\n    const platformFee = Math.ceil(budget * 0.1); // 10% platform fee\n    return c.json(\n      {\n        error: \"Payment Required\",\n        payment: {\n          amount: budget + platformFee,\n          token,\n          recipient: \"SP2QXPFF4M72QYZWXE7S5321XJDJ2DD32DGEMN5QA\", // Registry wallet\n          memo: `execute:${generateExecutionId()}`,\n          breakdown: {\n            agentBudget: budget,\n            platformFee,\n            total: budget + platformFee,\n          },\n        },\n        task,\n        estimatedAgents: 3,\n      },\n      402\n    );\n  }\n\n  // Simulate execution (in production, this would orchestrate real agents)\n  const executionId = generateExecutionId();\n  const startTime = Date.now();\n\n  // Find best agents for the task\n  const capabilities = inferCapabilities(task);\n  const selectedAgents = selectAgentsForTask(capabilities, budget, preferredAgents);\n\n  // Simulate calling each agent\n  const agentResults: ExecutionResult[\"agentsUsed\"] = [];\n  let remainingBudget = budget;\n\n  for (const agent of selectedAgents) {\n    if (remainingBudget < agent.pricing.basePrice) break;\n\n    agentResults.push({\n      agentId: agent.id,\n      endpoint: agent.endpoints[0] || \"internal\",\n      cost: agent.pricing.basePrice,\n      responseTime: Math.random() * 500 + 100,\n    });\n\n    remainingBudget -= agent.pricing.basePrice;\n  }\n\n  const totalCost = agentResults.reduce((sum, a) => sum + a.cost, 0);\n  const platformFee = Math.ceil(totalCost * 0.1);\n\n  const result: ExecutionResult = {\n    id: executionId,\n    task,\n    status: \"completed\",\n    result: {\n      summary: `Executed task \"${task}\" using ${agentResults.length} agents`,\n      output: \"This is a PoC - real execution would return actual results\",\n      confidence: 0.85,\n    },\n    agentsUsed: agentResults,\n    totalCost,\n    platformFee,\n    duration: Date.now() - startTime,\n  };\n\n  return c.json(result);\n});\n\n// Chain multiple agents\nagents.post(\"/chain\", async (c) => {\n  const body = await c.req.json();\n  const { steps, budget, token } = body;\n\n  if (!steps || !Array.isArray(steps) || steps.length === 0) {\n    return c.json({ error: \"Steps array required\" }, 400);\n  }\n\n  // Validate chain\n  const chainPlan = steps.map((step: any, index: number) => {\n    const agent = agentRegistry.get(step.agentId);\n    return {\n      step: index + 1,\n      agentId: step.agentId,\n      agentName: agent?.name || \"Unknown\",\n      action: step.action,\n      estimatedCost: agent?.pricing.basePrice || 0,\n      inputFrom: step.inputFrom || (index > 0 ? `step${index}` : \"user\"),\n    };\n  });\n\n  const totalEstimatedCost = chainPlan.reduce((sum, s) => sum + s.estimatedCost, 0);\n  const platformFee = Math.ceil(totalEstimatedCost * 0.1);\n\n  // Check payment\n  const paymentProof = c.req.header(\"X-Payment-Proof\");\n  if (!paymentProof) {\n    return c.json(\n      {\n        error: \"Payment Required\",\n        payment: {\n          amount: totalEstimatedCost + platformFee,\n          token: token || \"sBTC\",\n          recipient: \"SP2QXPFF4M72QYZWXE7S5321XJDJ2DD32DGEMN5QA\",\n          memo: `chain:${generateExecutionId()}`,\n        },\n        chain: chainPlan,\n        totalSteps: steps.length,\n      },\n      402\n    );\n  }\n\n  // Execute chain (simulated)\n  return c.json({\n    id: generateExecutionId(),\n    status: \"completed\",\n    chain: chainPlan,\n    results: chainPlan.map((step) => ({\n      step: step.step,\n      status: \"completed\",\n      output: `Result from ${step.agentName}`,\n    })),\n    totalCost: totalEstimatedCost,\n    platformFee,\n  });\n});\n\n// Register an agent\nagents.post(\"/register\", async (c) => {\n  const body = await c.req.json();\n  const { name, description, capabilities, endpoints, owner, pricing } = body;\n\n  if (!name || !capabilities || !owner || !pricing) {\n    return c.json({ error: \"Required: name, capabilities, owner, pricing\" }, 400);\n  }\n\n  const id = generateAgentId();\n  const agent: Agent = {\n    id,\n    name,\n    description: description || \"\",\n    capabilities,\n    endpoints: endpoints || [],\n    owner,\n    pricing,\n  };\n\n  agentRegistry.set(id, agent);\n\n  // Update capability index\n  capabilities.forEach((cap: string) => {\n    const existing = capabilityIndex.get(cap) || new Set();\n    existing.add(id);\n    capabilityIndex.set(cap, existing);\n  });\n\n  return c.json({\n    success: true,\n    agent: { id, name, capabilities },\n    message: \"Agent registered successfully\",\n  }, 201);\n});\n\n// List all agents\nagents.get(\"/\", (c) => {\n  const allAgents = Array.from(agentRegistry.values()).map((a) => ({\n    id: a.id,\n    name: a.name,\n    description: a.description,\n    capabilities: a.capabilities,\n    pricing: a.pricing,\n  }));\n\n  return c.json({\n    total: allAgents.length,\n    agents: allAgents,\n  });\n});\n\n// Helper functions\n\nfunction inferCapabilities(task: string): string[] {\n  const taskLower = task.toLowerCase();\n  const capabilities: string[] = [];\n\n  const capabilityKeywords: Record<string, string[]> = {\n    summarize: [\"summarize\", \"summary\", \"tldr\", \"condense\"],\n    translate: [\"translate\", \"translation\", \"language\"],\n    \"image-generate\": [\"generate image\", \"create image\", \"draw\", \"illustration\"],\n    \"image-analyze\": [\"analyze image\", \"describe image\", \"what's in this\"],\n    search: [\"search\", \"find\", \"look up\", \"google\"],\n    \"web-scrape\": [\"scrape\", \"extract from\", \"crawl\"],\n    \"code-generate\": [\"write code\", \"generate code\", \"create function\"],\n    \"code-analyze\": [\"analyze code\", \"review code\", \"explain code\"],\n    \"blockchain-query\": [\"blockchain\", \"transaction\", \"wallet\", \"balance\"],\n    \"data-transform\": [\"transform\", \"convert\", \"parse\", \"format\"],\n    sentiment: [\"sentiment\", \"feeling\", \"emotion\", \"tone\"],\n    classify: [\"classify\", \"categorize\", \"label\", \"tag\"],\n  };\n\n  for (const [capability, keywords] of Object.entries(capabilityKeywords)) {\n    if (keywords.some((kw) => taskLower.includes(kw))) {\n      capabilities.push(capability);\n    }\n  }\n\n  // Default to general if no specific capabilities found\n  if (capabilities.length === 0) {\n    capabilities.push(\"general\");\n  }\n\n  return capabilities;\n}\n\nfunction getCapabilityDescription(cap: string): string {\n  const descriptions: Record<string, string> = {\n    summarize: \"Condense long text into key points\",\n    translate: \"Convert text between languages\",\n    \"image-generate\": \"Create images from text descriptions\",\n    \"image-analyze\": \"Describe and analyze image contents\",\n    search: \"Search the web or databases\",\n    \"web-scrape\": \"Extract data from websites\",\n    \"code-generate\": \"Write code in various languages\",\n    \"code-analyze\": \"Review and explain code\",\n    \"blockchain-query\": \"Query blockchain data\",\n    \"data-transform\": \"Transform and convert data formats\",\n    sentiment: \"Analyze emotional tone of text\",\n    classify: \"Categorize and label content\",\n    general: \"General-purpose processing\",\n  };\n  return descriptions[cap] || \"Specialized capability\";\n}\n\nfunction buildExecutionPlan(\n  task: string,\n  agents: any[]\n): { steps: any[]; totalCost: number; estimatedTime: number } {\n  if (agents.length === 0) {\n    return { steps: [], totalCost: 0, estimatedTime: 0 };\n  }\n\n  const steps = agents.slice(0, 5).map((agent, index) => ({\n    step: index + 1,\n    agentId: agent.id,\n    agentName: agent.name,\n    action: `Execute: ${agent.matchedCapabilities.join(\", \")}`,\n    estimatedCost: agent.pricing.basePrice,\n    estimatedTime: 500 + index * 200,\n  }));\n\n  return {\n    steps,\n    totalCost: steps.reduce((sum, s) => sum + s.estimatedCost, 0),\n    estimatedTime: steps.reduce((sum, s) => sum + s.estimatedTime, 0),\n  };\n}\n\nfunction selectAgentsForTask(\n  capabilities: string[],\n  budget: number,\n  preferredAgents?: string[]\n): Agent[] {\n  const selected: Agent[] = [];\n  let remainingBudget = budget;\n\n  // First, try preferred agents\n  if (preferredAgents) {\n    for (const id of preferredAgents) {\n      const agent = agentRegistry.get(id);\n      if (agent && agent.pricing.basePrice <= remainingBudget) {\n        selected.push(agent);\n        remainingBudget -= agent.pricing.basePrice;\n      }\n    }\n  }\n\n  // Then fill with capability-matched agents\n  for (const cap of capabilities) {\n    const agentIds = capabilityIndex.get(cap);\n    if (!agentIds) continue;\n\n    for (const id of agentIds) {\n      if (selected.some((a) => a.id === id)) continue;\n\n      const agent = agentRegistry.get(id);\n      if (agent && agent.pricing.basePrice <= remainingBudget) {\n        selected.push(agent);\n        remainingBudget -= agent.pricing.basePrice;\n      }\n    }\n  }\n\n  return selected;\n}\n\nfunction generateExecutionId(): string {\n  return `exec_${Date.now()}_${Math.random().toString(36).substring(2, 8)}`;\n}\n\nfunction generateAgentId(): string {\n  return `agent_${Math.random().toString(36).substring(2, 10)}`;\n}\n", "/**\n * Payment routes - x402 payment infrastructure\n *\n * Universal payment layer for the registry:\n * - Create invoices\n * - Verify payments on-chain\n * - Manage credits/balances\n * - Subscription management\n */\n\nimport { Hono } from \"hono\";\nimport type { PaymentInvoice, RegistryEnv } from \"../types\";\n\nexport const payments = new Hono<{ Bindings: RegistryEnv }>();\n\n// In-memory stores for PoC\nconst invoices = new Map<string, PaymentInvoice>();\nconst balances = new Map<string, { sBTC: number; STX: number; USDh: number }>();\nconst subscriptions = new Map<string, any>();\n\n// Token contracts\nconst TOKEN_CONTRACTS = {\n  sBTC: \"SM3VDXK3WZZSA84XXFKAFAF15NNZX32CTSG82JFQ4.sbtc-token\",\n  STX: \"native\",\n  USDh: \"SP2VCQJGH7PHP2DJK7Z0V48AGBHQAW3R3ZW1QF4N.usdh\",\n};\n\n// Create payment invoice\npayments.post(\"/create-invoice\", async (c) => {\n  const body = await c.req.json();\n  const { amount, token, recipient, memo, expiresIn } = body;\n\n  if (!amount || !token || !recipient) {\n    return c.json({ error: \"Required: amount, token, recipient\" }, 400);\n  }\n\n  const id = generateInvoiceId();\n  const expiresAt = new Date(Date.now() + (expiresIn || 300) * 1000).toISOString();\n\n  const invoice: PaymentInvoice = {\n    id,\n    amount,\n    token,\n    recipient,\n    memo: memo || `invoice:${id}`,\n    expiresAt,\n    status: \"pending\",\n  };\n\n  invoices.set(id, invoice);\n\n  return c.json({\n    invoice: {\n      id: invoice.id,\n      amount: invoice.amount,\n      token: invoice.token,\n      recipient: invoice.recipient,\n      memo: invoice.memo,\n      expiresAt: invoice.expiresAt,\n    },\n    paymentInstructions: {\n      contract: TOKEN_CONTRACTS[token as keyof typeof TOKEN_CONTRACTS],\n      function: token === \"STX\" ? \"stx-transfer\" : \"transfer\",\n      args: [amount, recipient, invoice.memo],\n    },\n    qrData: `stacks:${recipient}?amount=${amount}&token=${token}&memo=${invoice.memo}`,\n  });\n});\n\n// Verify a payment\npayments.post(\"/verify\", async (c) => {\n  const body = await c.req.json();\n  const { txId, invoiceId } = body;\n\n  if (!txId) {\n    return c.json({ error: \"Transaction ID required\" }, 400);\n  }\n\n  // Fetch transaction from Stacks API\n  try {\n    const txResponse = await fetch(`https://api.mainnet.hiro.so/extended/v1/tx/${txId}`);\n\n    if (!txResponse.ok) {\n      return c.json({ error: \"Transaction not found\" }, 404);\n    }\n\n    const tx = (await txResponse.json()) as any;\n\n    // Check transaction status\n    if (tx.tx_status !== \"success\") {\n      return c.json({\n        verified: false,\n        status: tx.tx_status,\n        error: \"Transaction not successful\",\n      });\n    }\n\n    // Extract payment details from transaction\n    const paymentDetails = extractPaymentDetails(tx);\n\n    // If invoice ID provided, validate against it\n    if (invoiceId) {\n      const invoice = invoices.get(invoiceId);\n      if (!invoice) {\n        return c.json({ error: \"Invoice not found\" }, 404);\n      }\n\n      const isValid =\n        paymentDetails.amount >= invoice.amount &&\n        paymentDetails.recipient === invoice.recipient &&\n        paymentDetails.memo?.includes(invoice.memo);\n\n      if (isValid) {\n        invoice.status = \"paid\";\n        invoice.txId = txId;\n        invoices.set(invoiceId, invoice);\n      }\n\n      return c.json({\n        verified: isValid,\n        invoice: invoiceId,\n        transaction: {\n          txId,\n          amount: paymentDetails.amount,\n          token: paymentDetails.token,\n          sender: paymentDetails.sender,\n          recipient: paymentDetails.recipient,\n          memo: paymentDetails.memo,\n          blockHeight: tx.block_height,\n          timestamp: tx.burn_block_time_iso,\n        },\n      });\n    }\n\n    // Just verify the transaction exists and succeeded\n    return c.json({\n      verified: true,\n      transaction: {\n        txId,\n        status: tx.tx_status,\n        type: tx.tx_type,\n        sender: tx.sender_address,\n        blockHeight: tx.block_height,\n        timestamp: tx.burn_block_time_iso,\n        ...paymentDetails,\n      },\n    });\n  } catch (error: any) {\n    return c.json({ error: `Verification failed: ${error.message}` }, 500);\n  }\n});\n\n// Check credit balance\npayments.get(\"/balance/:address\", async (c) => {\n  const address = c.req.param(\"address\");\n\n  // Get cached balance or fetch from chain\n  let balance = balances.get(address);\n\n  if (!balance) {\n    // Fetch real balances from chain\n    balance = await fetchOnChainBalances(address);\n    balances.set(address, balance);\n  }\n\n  return c.json({\n    address,\n    balances: balance,\n    credits: {\n      available: balance.sBTC + balance.STX * 0.00001, // Normalize to sBTC equivalent\n      locked: 0,\n    },\n    lastUpdated: new Date().toISOString(),\n  });\n});\n\n// Deposit credits (records intent, user pays on-chain)\npayments.post(\"/deposit\", async (c) => {\n  const body = await c.req.json();\n  const { address, amount, token } = body;\n\n  if (!address || !amount || !token) {\n    return c.json({ error: \"Required: address, amount, token\" }, 400);\n  }\n\n  // Create deposit invoice\n  const invoice = {\n    id: generateInvoiceId(),\n    type: \"deposit\",\n    amount,\n    token,\n    recipient: \"SP2QXPFF4M72QYZWXE7S5321XJDJ2DD32DGEMN5QA\", // Registry wallet\n    memo: `deposit:${address}`,\n    expiresAt: new Date(Date.now() + 3600 * 1000).toISOString(),\n  };\n\n  return c.json({\n    depositInstructions: {\n      sendTo: invoice.recipient,\n      amount: invoice.amount,\n      token: invoice.token,\n      memo: invoice.memo,\n      contract: TOKEN_CONTRACTS[token as keyof typeof TOKEN_CONTRACTS],\n    },\n    invoiceId: invoice.id,\n    expiresAt: invoice.expiresAt,\n    note: \"After sending, call /payments/verify with txId to credit your account\",\n  });\n});\n\n// Set up subscription\npayments.post(\"/subscribe\", async (c) => {\n  const body = await c.req.json();\n  const { subscriber, endpointId, plan, token } = body;\n\n  if (!subscriber || !endpointId || !plan) {\n    return c.json({ error: \"Required: subscriber, endpointId, plan\" }, 400);\n  }\n\n  const plans: Record<string, { calls: number; price: number; period: string }> = {\n    basic: { calls: 100, price: 1000, period: \"month\" },\n    pro: { calls: 1000, price: 8000, period: \"month\" },\n    unlimited: { calls: -1, price: 50000, period: \"month\" },\n  };\n\n  const selectedPlan = plans[plan];\n  if (!selectedPlan) {\n    return c.json({ error: \"Invalid plan. Options: basic, pro, unlimited\" }, 400);\n  }\n\n  const subscriptionId = `sub_${Date.now()}_${Math.random().toString(36).substring(2, 8)}`;\n\n  // Check for payment\n  const paymentProof = c.req.header(\"X-Payment-Proof\");\n  if (!paymentProof) {\n    return c.json(\n      {\n        error: \"Payment Required\",\n        payment: {\n          amount: selectedPlan.price,\n          token: token || \"sBTC\",\n          recipient: \"SP2QXPFF4M72QYZWXE7S5321XJDJ2DD32DGEMN5QA\",\n          memo: `subscribe:${subscriptionId}`,\n        },\n        plan: {\n          name: plan,\n          ...selectedPlan,\n        },\n      },\n      402\n    );\n  }\n\n  // Create subscription\n  const subscription = {\n    id: subscriptionId,\n    subscriber,\n    endpointId,\n    plan,\n    callsRemaining: selectedPlan.calls,\n    callsUsed: 0,\n    startsAt: new Date().toISOString(),\n    expiresAt: new Date(Date.now() + 30 * 24 * 3600 * 1000).toISOString(),\n    status: \"active\",\n  };\n\n  subscriptions.set(subscriptionId, subscription);\n\n  return c.json({\n    success: true,\n    subscription,\n  });\n});\n\n// Get subscription status\npayments.get(\"/subscription/:id\", (c) => {\n  const id = c.req.param(\"id\");\n  const subscription = subscriptions.get(id);\n\n  if (!subscription) {\n    return c.json({ error: \"Subscription not found\" }, 404);\n  }\n\n  return c.json(subscription);\n});\n\n// Helper functions\n\nfunction generateInvoiceId(): string {\n  return `inv_${Date.now()}_${Math.random().toString(36).substring(2, 8)}`;\n}\n\nfunction extractPaymentDetails(tx: any): {\n  amount: number;\n  token: string;\n  sender: string;\n  recipient: string;\n  memo?: string;\n} {\n  // Handle STX transfer\n  if (tx.tx_type === \"token_transfer\") {\n    return {\n      amount: parseInt(tx.token_transfer.amount),\n      token: \"STX\",\n      sender: tx.sender_address,\n      recipient: tx.token_transfer.recipient_address,\n      memo: tx.token_transfer.memo ? Buffer.from(tx.token_transfer.memo, \"hex\").toString() : undefined,\n    };\n  }\n\n  // Handle contract call (SIP-010 transfer)\n  if (tx.tx_type === \"contract_call\") {\n    const args = tx.contract_call.function_args || [];\n    return {\n      amount: parseInt(args[0]?.repr?.replace(\"u\", \"\") || \"0\"),\n      token: tx.contract_call.contract_id.includes(\"sbtc\") ? \"sBTC\" : \"USDh\",\n      sender: tx.sender_address,\n      recipient: args[2]?.repr?.replace(/'/g, \"\") || \"\",\n      memo: args[3]?.repr,\n    };\n  }\n\n  return {\n    amount: 0,\n    token: \"unknown\",\n    sender: tx.sender_address,\n    recipient: \"\",\n  };\n}\n\nasync function fetchOnChainBalances(\n  address: string\n): Promise<{ sBTC: number; STX: number; USDh: number }> {\n  try {\n    // Fetch STX balance\n    const stxResponse = await fetch(\n      `https://api.mainnet.hiro.so/extended/v1/address/${address}/stx`\n    );\n    const stxData = (await stxResponse.json()) as any;\n    const stxBalance = parseInt(stxData.balance || \"0\");\n\n    // Fetch FT balances\n    const ftResponse = await fetch(\n      `https://api.mainnet.hiro.so/extended/v1/address/${address}/balances`\n    );\n    const ftData = (await ftResponse.json()) as any;\n\n    let sbtcBalance = 0;\n    let usdhBalance = 0;\n\n    const fungible = ftData.fungible_tokens || {};\n    for (const [key, value] of Object.entries(fungible)) {\n      if (key.includes(\"sbtc\")) {\n        sbtcBalance = parseInt((value as any).balance || \"0\");\n      }\n      if (key.includes(\"usdh\")) {\n        usdhBalance = parseInt((value as any).balance || \"0\");\n      }\n    }\n\n    return {\n      sBTC: sbtcBalance,\n      STX: stxBalance,\n      USDh: usdhBalance,\n    };\n  } catch {\n    return { sBTC: 0, STX: 0, USDh: 0 };\n  }\n}\n", "/**\n * Analytics routes - Usage and revenue tracking\n *\n * Provides developers with insights into their endpoints:\n * - Call volumes and trends\n * - Revenue tracking\n * - Caller demographics\n */\n\nimport { Hono } from \"hono\";\nimport type { RegistryEnv } from \"../types\";\n\nexport const analytics = new Hono<{ Bindings: RegistryEnv }>();\n\n// In-memory analytics store for PoC\nconst analyticsData = new Map<\n  string,\n  {\n    calls: { timestamp: number; caller: string; responseTime: number; paid: number }[];\n    revenue: { timestamp: number; amount: number; token: string; txId: string }[];\n  }\n>();\n\n// Get stats for all your endpoints\nanalytics.get(\"/my-endpoints\", (c) => {\n  const owner = c.req.header(\"X-Owner-Address\");\n\n  if (!owner) {\n    return c.json({ error: \"X-Owner-Address header required\" }, 401);\n  }\n\n  // Aggregate stats for all endpoints owned by this address\n  const endpoints: any[] = [];\n\n  analyticsData.forEach((data, endpointId) => {\n    const last24h = Date.now() - 24 * 3600 * 1000;\n    const calls24h = data.calls.filter((c) => c.timestamp > last24h);\n    const revenue24h = data.revenue\n      .filter((r) => r.timestamp > last24h)\n      .reduce((sum, r) => sum + r.amount, 0);\n\n    endpoints.push({\n      endpointId,\n      totalCalls: data.calls.length,\n      calls24h: calls24h.length,\n      totalRevenue: data.revenue.reduce((sum, r) => sum + r.amount, 0),\n      revenue24h,\n      avgResponseTime:\n        data.calls.length > 0\n          ? data.calls.reduce((sum, c) => sum + c.responseTime, 0) / data.calls.length\n          : 0,\n    });\n  });\n\n  return c.json({\n    owner,\n    endpoints,\n    summary: {\n      totalEndpoints: endpoints.length,\n      totalCalls: endpoints.reduce((sum, e) => sum + e.totalCalls, 0),\n      totalRevenue: endpoints.reduce((sum, e) => sum + e.totalRevenue, 0),\n      calls24h: endpoints.reduce((sum, e) => sum + e.calls24h, 0),\n      revenue24h: endpoints.reduce((sum, e) => sum + e.revenue24h, 0),\n    },\n  });\n});\n\n// Revenue dashboard\nanalytics.get(\"/revenue\", (c) => {\n  const owner = c.req.header(\"X-Owner-Address\");\n  const period = c.req.query(\"period\") || \"7d\";\n\n  if (!owner) {\n    return c.json({ error: \"X-Owner-Address header required\" }, 401);\n  }\n\n  const periodMs = parsePeriod(period);\n  const cutoff = Date.now() - periodMs;\n\n  // Aggregate revenue data\n  const revenueByDay = new Map<string, { sBTC: number; STX: number; USDh: number }>();\n  const revenueByEndpoint = new Map<string, number>();\n\n  analyticsData.forEach((data, endpointId) => {\n    data.revenue\n      .filter((r) => r.timestamp > cutoff)\n      .forEach((r) => {\n        // By day\n        const day = new Date(r.timestamp).toISOString().split(\"T\")[0];\n        const dayData = revenueByDay.get(day) || { sBTC: 0, STX: 0, USDh: 0 };\n        dayData[r.token as keyof typeof dayData] += r.amount;\n        revenueByDay.set(day, dayData);\n\n        // By endpoint\n        revenueByEndpoint.set(endpointId, (revenueByEndpoint.get(endpointId) || 0) + r.amount);\n      });\n  });\n\n  // Sort by day\n  const dailyRevenue = Array.from(revenueByDay.entries())\n    .sort(([a], [b]) => a.localeCompare(b))\n    .map(([date, amounts]) => ({ date, ...amounts }));\n\n  // Top endpoints by revenue\n  const topEndpoints = Array.from(revenueByEndpoint.entries())\n    .sort(([, a], [, b]) => b - a)\n    .slice(0, 10)\n    .map(([endpointId, revenue]) => ({ endpointId, revenue }));\n\n  return c.json({\n    period,\n    dailyRevenue,\n    topEndpoints,\n    totals: {\n      sBTC: dailyRevenue.reduce((sum, d) => sum + d.sBTC, 0),\n      STX: dailyRevenue.reduce((sum, d) => sum + d.STX, 0),\n      USDh: dailyRevenue.reduce((sum, d) => sum + d.USDh, 0),\n    },\n  });\n});\n\n// Who's calling your APIs\nanalytics.get(\"/callers\", (c) => {\n  const owner = c.req.header(\"X-Owner-Address\");\n  const endpointId = c.req.query(\"endpoint\");\n\n  if (!owner) {\n    return c.json({ error: \"X-Owner-Address header required\" }, 401);\n  }\n\n  const callerStats = new Map<\n    string,\n    { calls: number; totalPaid: number; avgResponseTime: number; lastSeen: number }\n  >();\n\n  const filterEndpoints = endpointId ? [endpointId] : Array.from(analyticsData.keys());\n\n  filterEndpoints.forEach((epId) => {\n    const data = analyticsData.get(epId);\n    if (!data) return;\n\n    data.calls.forEach((call) => {\n      const existing = callerStats.get(call.caller) || {\n        calls: 0,\n        totalPaid: 0,\n        avgResponseTime: 0,\n        lastSeen: 0,\n      };\n      existing.calls++;\n      existing.totalPaid += call.paid;\n      existing.avgResponseTime =\n        (existing.avgResponseTime * (existing.calls - 1) + call.responseTime) / existing.calls;\n      existing.lastSeen = Math.max(existing.lastSeen, call.timestamp);\n      callerStats.set(call.caller, existing);\n    });\n  });\n\n  // Sort by calls\n  const topCallers = Array.from(callerStats.entries())\n    .sort(([, a], [, b]) => b.calls - a.calls)\n    .slice(0, 50)\n    .map(([address, stats]) => ({\n      address,\n      ...stats,\n      lastSeen: new Date(stats.lastSeen).toISOString(),\n    }));\n\n  return c.json({\n    endpoint: endpointId || \"all\",\n    uniqueCallers: callerStats.size,\n    topCallers,\n  });\n});\n\n// Record a call (internal use)\nanalytics.post(\"/record-call\", async (c) => {\n  const body = await c.req.json();\n  const { endpointId, caller, responseTime, paid } = body;\n\n  if (!endpointId || !caller) {\n    return c.json({ error: \"Required: endpointId, caller\" }, 400);\n  }\n\n  const data = analyticsData.get(endpointId) || { calls: [], revenue: [] };\n  data.calls.push({\n    timestamp: Date.now(),\n    caller,\n    responseTime: responseTime || 0,\n    paid: paid || 0,\n  });\n\n  if (paid > 0) {\n    data.revenue.push({\n      timestamp: Date.now(),\n      amount: paid,\n      token: \"sBTC\",\n      txId: \"\",\n    });\n  }\n\n  analyticsData.set(endpointId, data);\n\n  return c.json({ success: true });\n});\n\n// Helper functions\n\nfunction parsePeriod(period: string): number {\n  const match = period.match(/^(\\d+)([hdwm])$/);\n  if (!match) return 7 * 24 * 3600 * 1000; // default 7 days\n\n  const value = parseInt(match[1]);\n  const unit = match[2];\n\n  switch (unit) {\n    case \"h\":\n      return value * 3600 * 1000;\n    case \"d\":\n      return value * 24 * 3600 * 1000;\n    case \"w\":\n      return value * 7 * 24 * 3600 * 1000;\n    case \"m\":\n      return value * 30 * 24 * 3600 * 1000;\n    default:\n      return 7 * 24 * 3600 * 1000;\n  }\n}\n", "/**\n * Developer tools routes\n *\n * Make it trivially easy to build x402 endpoints:\n * - Generate middleware code\n * - Test endpoint compliance\n * - Pricing calculator\n */\n\nimport { Hono } from \"hono\";\nimport type { RegistryEnv } from \"../types\";\n\nexport const dev = new Hono<{ Bindings: RegistryEnv }>();\n\n// Generate x402 middleware\ndev.post(\"/generate-middleware\", async (c) => {\n  const body = await c.req.json();\n  const { language, framework, price, token, walletAddress } = body;\n\n  if (!language || !price || !token || !walletAddress) {\n    return c.json({ error: \"Required: language, price, token, walletAddress\" }, 400);\n  }\n\n  const code = generateMiddlewareCode(language, framework, price, token, walletAddress);\n\n  return c.json({\n    language,\n    framework: framework || \"none\",\n    code,\n    usage: getUsageInstructions(language, framework),\n  });\n});\n\n// Test endpoint compliance\ndev.post(\"/test-endpoint\", async (c) => {\n  const body = await c.req.json();\n  const { url, method = \"GET\" } = body;\n\n  if (!url) {\n    return c.json({ error: \"URL required\" }, 400);\n  }\n\n  const tests: { name: string; passed: boolean; details: string }[] = [];\n\n  try {\n    // Test 1: Endpoint reachable\n    const start = Date.now();\n    const response = await fetch(url, { method });\n    const responseTime = Date.now() - start;\n\n    tests.push({\n      name: \"Endpoint reachable\",\n      passed: true,\n      details: `Response time: ${responseTime}ms`,\n    });\n\n    // Test 2: Returns 402\n    const returns402 = response.status === 402;\n    tests.push({\n      name: \"Returns 402 Payment Required\",\n      passed: returns402,\n      details: returns402 ? \"Correct status code\" : `Got ${response.status} instead`,\n    });\n\n    // Test 3: Payment details in response\n    let paymentDetails: any = null;\n    if (returns402) {\n      try {\n        paymentDetails = await response.json();\n      } catch {\n        paymentDetails = null;\n      }\n    }\n\n    const hasPaymentInfo = !!(\n      paymentDetails?.maxAmountRequired ||\n      paymentDetails?.amount ||\n      paymentDetails?.payment?.amount\n    );\n\n    tests.push({\n      name: \"Contains payment information\",\n      passed: hasPaymentInfo,\n      details: hasPaymentInfo\n        ? `Amount: ${paymentDetails?.maxAmountRequired || paymentDetails?.amount || paymentDetails?.payment?.amount}`\n        : \"Missing amount field\",\n    });\n\n    // Test 4: Has recipient address\n    const hasRecipient = !!(\n      paymentDetails?.payTo ||\n      paymentDetails?.recipient ||\n      paymentDetails?.payment?.address\n    );\n\n    tests.push({\n      name: \"Has recipient address\",\n      passed: hasRecipient,\n      details: hasRecipient\n        ? `Pay to: ${paymentDetails?.payTo || paymentDetails?.recipient || paymentDetails?.payment?.address}`\n        : \"Missing recipient field\",\n    });\n\n    // Test 5: Token type specified\n    const hasToken = !!(paymentDetails?.tokenType || paymentDetails?.token || paymentDetails?.payment?.token);\n\n    tests.push({\n      name: \"Token type specified\",\n      passed: hasToken,\n      details: hasToken\n        ? `Token: ${paymentDetails?.tokenType || paymentDetails?.token || paymentDetails?.payment?.token}`\n        : \"Missing token field (defaults to STX)\",\n    });\n\n    // Test 6: CORS headers\n    const hasCors = !!response.headers.get(\"Access-Control-Allow-Origin\");\n    tests.push({\n      name: \"CORS enabled\",\n      passed: hasCors,\n      details: hasCors ? \"CORS headers present\" : \"Missing CORS headers (may block browser calls)\",\n    });\n\n    const allPassed = tests.every((t) => t.passed);\n    const criticalPassed = tests.slice(0, 4).every((t) => t.passed);\n\n    return c.json({\n      url,\n      compliant: criticalPassed,\n      fullyCompliant: allPassed,\n      tests,\n      paymentDetails,\n      recommendations: generateRecommendations(tests),\n    });\n  } catch (error: any) {\n    tests.push({\n      name: \"Endpoint reachable\",\n      passed: false,\n      details: `Error: ${error.message}`,\n    });\n\n    return c.json({\n      url,\n      compliant: false,\n      tests,\n      error: error.message,\n    });\n  }\n});\n\n// Pricing calculator\ndev.get(\"/pricing-calculator\", (c) => {\n  const category = c.req.query(\"category\") || \"utility\";\n  const complexity = c.req.query(\"complexity\") || \"medium\";\n  const token = c.req.query(\"token\") || \"sBTC\";\n\n  // Market data (would be fetched from real sources)\n  const marketPrices = {\n    sBTC: { usd: 100000 },\n    STX: { usd: 0.5 },\n    USDh: { usd: 1 },\n  };\n\n  // Base prices by category (in USD cents)\n  const categoryPrices: Record<string, number> = {\n    utility: 1, // $0.01\n    ai: 10, // $0.10\n    blockchain: 5, // $0.05\n    data: 3, // $0.03\n    media: 15, // $0.15\n  };\n\n  // Complexity multipliers\n  const complexityMultipliers: Record<string, number> = {\n    simple: 0.5,\n    medium: 1,\n    complex: 2,\n    premium: 5,\n  };\n\n  const basePrice = categoryPrices[category] || 5;\n  const multiplier = complexityMultipliers[complexity] || 1;\n  const priceUsdCents = basePrice * multiplier;\n\n  // Convert to token amounts\n  const tokenPrice = marketPrices[token as keyof typeof marketPrices] || marketPrices.sBTC;\n  const priceInToken = Math.ceil((priceUsdCents / 100) / tokenPrice.usd * 100000000); // in smallest unit\n\n  return c.json({\n    recommendation: {\n      price: priceInToken,\n      token,\n      priceUsd: `$${(priceUsdCents / 100).toFixed(4)}`,\n    },\n    inputs: {\n      category,\n      complexity,\n    },\n    marketData: {\n      token,\n      priceUsd: tokenPrice.usd,\n    },\n    comparisons: {\n      sBTC: Math.ceil((priceUsdCents / 100) / marketPrices.sBTC.usd * 100000000),\n      STX: Math.ceil((priceUsdCents / 100) / marketPrices.STX.usd * 1000000),\n      USDh: Math.ceil((priceUsdCents / 100) * 1000000),\n    },\n    tips: [\n      \"Start lower to attract users, raise prices as demand grows\",\n      \"AI endpoints can command 5-10x premium over utility endpoints\",\n      \"Consider offering volume discounts via subscriptions\",\n      \"Monitor competitor pricing in the registry\",\n    ],\n  });\n});\n\n// SDK download links\ndev.get(\"/sdk/:language\", (c) => {\n  const language = c.req.param(\"language\");\n\n  const sdks: Record<string, any> = {\n    typescript: {\n      package: \"@x402/sdk\",\n      install: \"npm install @x402/sdk\",\n      repo: \"https://github.com/x402-registry/sdk-typescript\",\n      example: `\nimport { x402 } from '@x402/sdk';\n\n// Create client\nconst client = x402.createClient({\n  wallet: 'SP...',\n  privateKey: process.env.STACKS_PRIVATE_KEY,\n});\n\n// Call a paid endpoint\nconst result = await client.call('https://api.example.com/summarize', {\n  body: { text: 'Long article...' },\n  maxPayment: 1000, // sats\n});\n`,\n    },\n    python: {\n      package: \"x402-sdk\",\n      install: \"pip install x402-sdk\",\n      repo: \"https://github.com/x402-registry/sdk-python\",\n      example: `\nfrom x402 import Client\n\nclient = Client(\n    wallet=\"SP...\",\n    private_key=os.environ[\"STACKS_PRIVATE_KEY\"]\n)\n\nresult = client.call(\n    \"https://api.example.com/summarize\",\n    body={\"text\": \"Long article...\"},\n    max_payment=1000\n)\n`,\n    },\n    go: {\n      package: \"github.com/x402-registry/sdk-go\",\n      install: \"go get github.com/x402-registry/sdk-go\",\n      repo: \"https://github.com/x402-registry/sdk-go\",\n      example: `\nimport \"github.com/x402-registry/sdk-go\"\n\nclient := x402.NewClient(x402.Config{\n    Wallet:     \"SP...\",\n    PrivateKey: os.Getenv(\"STACKS_PRIVATE_KEY\"),\n})\n\nresult, err := client.Call(\"https://api.example.com/summarize\", x402.CallOptions{\n    Body:       map[string]string{\"text\": \"Long article...\"},\n    MaxPayment: 1000,\n})\n`,\n    },\n  };\n\n  const sdk = sdks[language];\n  if (!sdk) {\n    return c.json({\n      error: \"SDK not found\",\n      available: Object.keys(sdks),\n    }, 404);\n  }\n\n  return c.json({\n    language,\n    ...sdk,\n  });\n});\n\n// Helper functions\n\nfunction generateMiddlewareCode(\n  language: string,\n  framework: string | undefined,\n  price: number,\n  token: string,\n  walletAddress: string\n): string {\n  if (language === \"typescript\" || language === \"javascript\") {\n    if (framework === \"hono\") {\n      return `\nimport { MiddlewareHandler } from 'hono';\n\nexport const x402Middleware = (): MiddlewareHandler => {\n  return async (c, next) => {\n    const paymentProof = c.req.header('X-Payment-Proof');\n\n    if (!paymentProof) {\n      return c.json({\n        error: 'Payment Required',\n        payment: {\n          amount: ${price},\n          token: '${token}',\n          address: '${walletAddress}',\n          memo: 'api-call',\n        },\n      }, 402);\n    }\n\n    // Verify payment on-chain\n    const verified = await verifyPayment(paymentProof, ${price});\n    if (!verified) {\n      return c.json({ error: 'Invalid payment' }, 402);\n    }\n\n    await next();\n  };\n};\n\nasync function verifyPayment(txId: string, expectedAmount: number): Promise<boolean> {\n  const response = await fetch(\\`https://api.mainnet.hiro.so/extended/v1/tx/\\${txId}\\`);\n  const tx = await response.json();\n  return tx.tx_status === 'success';\n}\n`;\n    }\n\n    // Express\n    return `\nconst x402Middleware = (req, res, next) => {\n  const paymentProof = req.headers['x-payment-proof'];\n\n  if (!paymentProof) {\n    return res.status(402).json({\n      error: 'Payment Required',\n      payment: {\n        amount: ${price},\n        token: '${token}',\n        address: '${walletAddress}',\n        memo: 'api-call',\n      },\n    });\n  }\n\n  // Verify payment (implement verification logic)\n  next();\n};\n\nmodule.exports = x402Middleware;\n`;\n  }\n\n  if (language === \"python\") {\n    return `\nfrom functools import wraps\nfrom flask import request, jsonify\n\ndef x402_required(f):\n    @wraps(f)\n    def decorated(*args, **kwargs):\n        payment_proof = request.headers.get('X-Payment-Proof')\n\n        if not payment_proof:\n            return jsonify({\n                'error': 'Payment Required',\n                'payment': {\n                    'amount': ${price},\n                    'token': '${token}',\n                    'address': '${walletAddress}',\n                    'memo': 'api-call',\n                }\n            }), 402\n\n        # Verify payment on-chain\n        if not verify_payment(payment_proof, ${price}):\n            return jsonify({'error': 'Invalid payment'}), 402\n\n        return f(*args, **kwargs)\n    return decorated\n`;\n  }\n\n  return `// Middleware for ${language} not yet available`;\n}\n\nfunction getUsageInstructions(language: string, framework: string | undefined): string {\n  if (language === \"typescript\" && framework === \"hono\") {\n    return `\n// Apply to specific routes:\napp.use('/api/paid/*', x402Middleware());\n\n// Or to entire app:\napp.use(x402Middleware());\n`;\n  }\n\n  if (language === \"python\") {\n    return `\n# Apply to specific routes:\n@app.route('/api/paid')\n@x402_required\ndef paid_endpoint():\n    return {'data': 'premium content'}\n`;\n  }\n\n  return \"See SDK documentation for usage instructions\";\n}\n\nfunction generateRecommendations(tests: { name: string; passed: boolean }[]): string[] {\n  const recommendations: string[] = [];\n\n  tests.forEach((test) => {\n    if (!test.passed) {\n      switch (test.name) {\n        case \"Returns 402 Payment Required\":\n          recommendations.push(\"Return HTTP 402 status code for unpaid requests\");\n          break;\n        case \"Contains payment information\":\n          recommendations.push(\"Include 'amount' or 'maxAmountRequired' in 402 response body\");\n          break;\n        case \"Has recipient address\":\n          recommendations.push(\"Include 'payTo' or 'recipient' Stacks address in response\");\n          break;\n        case \"Token type specified\":\n          recommendations.push(\"Specify 'tokenType' (sBTC, STX, or USDh) in response\");\n          break;\n        case \"CORS enabled\":\n          recommendations.push(\"Add CORS headers to allow browser-based agent calls\");\n          break;\n      }\n    }\n  });\n\n  if (recommendations.length === 0) {\n    recommendations.push(\"Your endpoint is fully x402 compliant!\");\n    recommendations.push(\"Consider registering it at POST /registry/register\");\n  }\n\n  return recommendations;\n}\n", "/**\n * x402 Registry - The App Store for AI Agents\n *\n * A platform for discovering, registering, and orchestrating x402-gated endpoints.\n * Enables agent-to-agent payments and composable AI services.\n */\n\nimport { Hono } from \"hono\";\nimport { cors } from \"hono/cors\";\nimport { registry } from \"./routes/registry\";\nimport { agents } from \"./routes/agents\";\nimport { payments } from \"./routes/payments\";\nimport { analytics } from \"./routes/analytics\";\nimport { dev } from \"./routes/dev\";\n\nconst app = new Hono();\n\napp.use(\"*\", cors());\n\n// API info\napp.get(\"/\", (c) => {\n  return c.json({\n    name: \"x402 Registry\",\n    version: \"1.0.0\",\n    tagline: \"The App Store for AI Agents\",\n    description: \"Discover, register, and orchestrate x402-gated endpoints\",\n    endpoints: {\n      \"GET /\": \"API info\",\n      \"GET /stats\": \"Platform statistics\",\n\n      // Registry\n      \"POST /registry/register\": \"Register your x402 endpoint\",\n      \"GET /registry/search\": \"Search endpoints by tag/category\",\n      \"GET /registry/discover\": \"Trending and featured endpoints\",\n      \"GET /registry/:id\": \"Get endpoint details\",\n      \"GET /registry/:id/stats\": \"Endpoint usage statistics\",\n      \"DELETE /registry/:id\": \"Remove your endpoint\",\n\n      // Agents\n      \"GET /agents/capabilities\": \"What can agents do?\",\n      \"POST /agents/recommend\": \"Find agents for a task\",\n      \"GET /agents/:id/openapi\": \"Machine-readable spec\",\n      \"POST /agents/execute\": \"Execute a task across agents\",\n      \"POST /agents/chain\": \"Compose multiple agents\",\n\n      // Payments\n      \"POST /payments/create-invoice\": \"Create payment request\",\n      \"POST /payments/verify\": \"Verify a payment\",\n      \"GET /payments/balance/:address\": \"Check credit balance\",\n      \"POST /payments/deposit\": \"Add credits\",\n      \"POST /payments/subscribe\": \"Set up recurring payments\",\n\n      // Analytics\n      \"GET /analytics/my-endpoints\": \"Your endpoint stats\",\n      \"GET /analytics/revenue\": \"Revenue dashboard\",\n      \"GET /analytics/callers\": \"Who's calling your APIs\",\n\n      // Developer Tools\n      \"POST /dev/generate-middleware\": \"Generate x402 middleware code\",\n      \"POST /dev/test-endpoint\": \"Validate your x402 setup\",\n      \"GET /dev/pricing-calculator\": \"Optimal pricing suggestions\",\n    },\n    tokens: [\"STX\", \"sBTC\", \"USDh\"],\n    network: \"stacks-mainnet\",\n  });\n});\n\n// Platform stats\napp.get(\"/stats\", (c) => {\n  return c.json({\n    totalEndpoints: 0,\n    totalAgents: 0,\n    totalCalls24h: 0,\n    totalVolume24h: \"0\",\n    topCategories: [\"ai\", \"blockchain\", \"data\", \"utility\"],\n    featuredEndpoints: [],\n  });\n});\n\n// Mount routes\napp.route(\"/registry\", registry);\napp.route(\"/agents\", agents);\napp.route(\"/payments\", payments);\napp.route(\"/analytics\", analytics);\napp.route(\"/dev\", dev);\n\nexport default app;\n"],
  "mappings": "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",
  "names": ["compose", "__name", "middleware", "onError", "onNotFound", "context", "next", "index", "dispatch", "i", "res", "isError", "handler", "err", "GET_MATCH_RESULT", "parseBody", "__name", "request", "options", "all", "dot", "contentType", "HonoRequest", "parseFormData", "formData", "convertFormDataToBodyData", "form", "value", "key", "handleParsingAllValues", "handleParsingNestedValues", "nestedForm", "keys", "key2", "index", "splitPath", "__name", "path", "paths", "splitRoutingPath", "routePath", "groups", "extractGroupsFromPath", "replaceGroupMarks", "match", "index", "mark", "i", "j", "patternCache", "getPattern", "label", "next", "cacheKey", "tryDecode", "str", "decoder", "tryDecodeURI", "getPath", "request", "url", "start", "charCode", "queryIndex", "getPathNoStrict", "__name", "request", "result", "getPath", "mergePath", "base", "sub", "rest", "checkOptionalParameter", "path", "segments", "results", "basePath", "segment", "optionalSegment", "v", "i", "a", "_decodeURI", "value", "tryDecode", "decodeURIComponent_", "_getQueryParam", "url", "key", "multiple", "encoded", "keyIndex2", "trailingKeyCode", "valueIndex", "endIndex", "keyIndex", "nextKeyIndex", "name", "getQueryParam", "getQueryParams", "tryDecodeURIComponent", "__name", "str", "tryDecode", "decodeURIComponent_", "HonoRequest", "#validatedData", "#matchResult", "request", "path", "matchResult", "key", "#getDecodedParam", "#getAllDecodedParams", "paramKey", "param", "#getParamValue", "decoded", "keys", "value", "getQueryParam", "getQueryParams", "name", "headerData", "options", "parseBody", "#cachedBody", "bodyCache", "raw", "cachedBody", "anyCachedKey", "body", "text", "target", "data", "GET_MATCH_RESULT", "route", "HtmlEscapedCallbackPhase", "raw", "__name", "value", "callbacks", "escapedString", "resolveCallback", "__name", "str", "phase", "preserveCallbacks", "context", "buffer", "callbacks", "resStr", "res", "str2", "raw", "TEXT_PLAIN", "setDefaultContentType", "__name", "contentType", "headers", "Context", "#rawRequest", "#req", "#var", "#status", "#executionCtx", "#res", "#layout", "#renderer", "#notFoundHandler", "#preparedHeaders", "#matchResult", "#path", "req", "options", "HonoRequest", "_res", "k", "v", "cookies", "cookie", "args", "content", "layout", "renderer", "name", "value", "status", "key", "#newResponse", "data", "arg", "responseHeaders", "argHeaders", "v2", "text", "object", "html", "res", "html2", "resolveCallback", "HtmlEscapedCallbackPhase", "location", "locationString", "METHOD_NAME_ALL", "METHOD_NAME_ALL_LOWERCASE", "METHODS", "MESSAGE_MATCHER_IS_ALREADY_BUILT", "UnsupportedPathError", "__name", "COMPOSED_HANDLER", "notFoundHandler", "__name", "c", "errorHandler", "err", "res", "Hono", "_Hono", "#path", "options", "METHODS", "METHOD_NAME_ALL_LOWERCASE", "method", "args1", "args", "#addRoute", "handler", "path", "handlers", "p", "m", "arg1", "METHOD_NAME_ALL", "strict", "optionsWithoutStrict", "getPath", "getPathNoStrict", "#clone", "clone", "#notFoundHandler", "app", "subApp", "r", "next", "compose", "COMPOSED_HANDLER", "mergePath", "applicationHandler", "replaceRequest", "optionHandler", "request", "getOptions", "options2", "executionContext", "mergedPath", "pathPrefixLength", "url", "#handleError", "#dispatch", "executionCtx", "env", "matchResult", "Context", "resolved", "composed", "context", "rest", "input", "requestInit", "Env", "event", "emptyParam", "match", "method", "path", "matchers", "match2", "__name", "method2", "path2", "matcher", "METHOD_NAME_ALL", "staticMatch", "match3", "index", "LABEL_REG_EXP_STR", "ONLY_WILDCARD_REG_EXP_STR", "TAIL_WILDCARD_REG_EXP_STR", "PATH_ERROR", "regExpMetaChars", "compareKey", "a", "b", "__name", "Node", "_Node", "#index", "#varIndex", "#children", "tokens", "index", "paramMap", "context", "pathErrorCheckOnly", "token", "restTokens", "pattern", "node", "name", "regexpStr", "k", "strList", "c", "Trie", "__name", "#context", "#root", "Node", "path", "index", "pathErrorCheckOnly", "paramAssoc", "groups", "replaced", "m", "mark", "tokens", "j", "regexp", "captureIndex", "indexReplacementMap", "paramReplacementMap", "_", "handlerIndex", "paramIndex", "nullMatcher", "wildcardRegExpCache", "buildWildcardRegExp", "path", "_", "metaChar", "__name", "clearWildcardRegExpCache", "buildMatcherFromPreprocessedRoutes", "routes", "trie", "Trie", "handlerData", "routesWithStaticPathFlag", "route", "isStaticA", "pathA", "isStaticB", "pathB", "staticMap", "i", "j", "len", "pathErrorCheckOnly", "handlers", "h", "emptyParam", "paramAssoc", "e", "PATH_ERROR", "UnsupportedPathError", "paramCount", "paramIndexMap", "key", "value", "regexp", "indexReplacementMap", "paramReplacementMap", "len2", "map", "keys", "k", "len3", "handlerMap", "findMiddleware", "middleware", "a", "b", "RegExpRouter", "#middleware", "#routes", "METHOD_NAME_ALL", "method", "handler", "MESSAGE_MATCHER_IS_ALREADY_BUILT", "p", "re", "m", "paths", "checkOptionalParameter", "path2", "match", "matchers", "#buildMatcher", "hasOwnRoute", "r", "ownRoute", "SmartRouter", "__name", "#routers", "#routes", "init", "method", "path", "handler", "MESSAGE_MATCHER_IS_ALREADY_BUILT", "routers", "routes", "len", "i", "res", "router", "i2", "len2", "e", "UnsupportedPathError", "emptyParams", "Node", "_Node", "__name", "#methods", "#children", "#patterns", "#order", "#params", "method", "handler", "children", "m", "path", "curNode", "parts", "splitRoutingPath", "possibleKeys", "i", "len", "p", "nextP", "pattern", "getPattern", "key", "v", "a", "#getHandlerSets", "node", "nodeParams", "params", "handlerSets", "handlerSet", "METHOD_NAME_ALL", "processedSet", "i2", "len2", "processed", "curNodes", "splitPath", "curNodesQueue", "part", "isLast", "tempNodes", "j", "nextNode", "k", "len3", "astNode", "name", "matcher", "child", "restPathString", "componentCount", "b", "TrieRouter", "__name", "#node", "Node", "method", "path", "handler", "results", "checkOptionalParameter", "i", "len", "Hono", "__name", "options", "SmartRouter", "RegExpRouter", "TrieRouter", "cors", "__name", "options", "opts", "findAllowOrigin", "optsOrigin", "origin", "findAllowMethods", "optsAllowMethods", "c", "next", "set", "key", "value", "allowOrigin", "allowMethods", "headers", "requestHeaders", "registry", "Hono", "endpoints", "c", "body", "url", "name", "description", "owner", "price", "token", "tags", "category", "openApiSpec", "verification", "verifyX402Endpoint", "id", "generateId", "endpoint", "tag", "q", "limit", "offset", "results", "e", "query", "t", "a", "b", "total", "summarizeEndpoint", "allEndpoints", "trending", "newest", "categories", "cat", "byCategory", "eps", "updates", "allowedUpdates", "key", "start", "response", "responseTime", "error", "__name", "agents", "Hono", "agentRegistry", "capabilityIndex", "c", "allCapabilities", "capabilityDetails", "cap", "agentIds", "getCapabilityDescription", "body", "task", "budget", "token", "capabilities", "neededCapabilities", "inferCapabilities", "matchingAgents", "agent", "matched", "a", "b", "recommendations", "m", "executionPlan", "buildExecutionPlan", "id", "spec", "preferredAgents", "timeout", "platformFee", "generateExecutionId", "executionId", "startTime", "selectedAgents", "selectAgentsForTask", "agentResults", "remainingBudget", "totalCost", "sum", "result", "steps", "chainPlan", "step", "index", "totalEstimatedCost", "s", "name", "description", "endpoints", "owner", "pricing", "generateAgentId", "existing", "allAgents", "taskLower", "capabilityKeywords", "capability", "keywords", "kw", "__name", "selected", "payments", "Hono", "invoices", "balances", "subscriptions", "TOKEN_CONTRACTS", "c", "body", "amount", "token", "recipient", "memo", "expiresIn", "id", "generateInvoiceId", "expiresAt", "invoice", "txId", "invoiceId", "txResponse", "tx", "paymentDetails", "extractPaymentDetails", "isValid", "error", "address", "balance", "fetchOnChainBalances", "subscriber", "endpointId", "plan", "selectedPlan", "subscriptionId", "subscription", "__name", "args", "stxData", "stxBalance", "ftData", "sbtcBalance", "usdhBalance", "fungible", "key", "value", "analytics", "Hono", "analyticsData", "c", "owner", "endpoints", "data", "endpointId", "last24h", "calls24h", "revenue24h", "r", "sum", "e", "period", "periodMs", "parsePeriod", "cutoff", "revenueByDay", "revenueByEndpoint", "day", "dayData", "dailyRevenue", "a", "b", "date", "amounts", "topEndpoints", "revenue", "d", "callerStats", "epId", "call", "existing", "topCallers", "address", "stats", "body", "caller", "responseTime", "paid", "match", "value", "__name", "dev", "Hono", "c", "body", "language", "framework", "price", "token", "walletAddress", "code", "generateMiddlewareCode", "getUsageInstructions", "url", "method", "tests", "start", "response", "responseTime", "returns402", "paymentDetails", "hasPaymentInfo", "hasRecipient", "hasToken", "hasCors", "allPassed", "t", "criticalPassed", "generateRecommendations", "error", "category", "complexity", "marketPrices", "categoryPrices", "complexityMultipliers", "basePrice", "multiplier", "priceUsdCents", "tokenPrice", "priceInToken", "sdks", "sdk", "__name", "recommendations", "test", "app", "Hono", "cors", "c", "registry", "agents", "payments", "analytics", "dev", "index_default"]
}
